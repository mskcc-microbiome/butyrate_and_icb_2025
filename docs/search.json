[
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html",
    "href": "figure_2_acoa_pathway_icb_outcome.html",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "",
    "text": "Here are the column names of the data we are plotting:\nfouraminobutyrate, glutarate, lysine and pyruvate represent different parts of the butyrate synthesis pathway.\n[1] \"blinded_subject_id\"    \"id_int\"                \"cohort\"               \n [4] \"age\"                   \"impact_tmb_score\"      \"cpb_drug\"             \n [7] \"ecog\"                  \"best_overall_response\" \"tt_pfs_d\"             \n[10] \"pfs_event\"             \"tt_os_d\"               \"event_os\"             \n[13] \"TMPT\"                  \"WMS_SGPID\"             \"SAMPID\"               \n[16] \"total\"                 \"samp_id\"               \"identifier.y\"         \n[19] \"Shannon\"               \"tx\"                    \"age10\"                \n[22] \"med_buty\"              \"fouraminobutyrate\"     \"gluatarate\"           \n[25] \"lysine\"                \"pyruvate\""
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "href": "figure_2_acoa_pathway_icb_outcome.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Survival plots as a function of pyruvate gene abundance:",
    "text": "Survival plots as a function of pyruvate gene abundance:\n\nPanel A\nOverall Survival (OS) by above/below median ACoA pathway gene abundance.\n\n# cut the distribution of pyruvate into above/below median:\nacoa_df &lt;- acoa_df %&gt;%\n  filter(!is.na(pyruvate)) %&gt;%\n  mutate(med_p = cut(pyruvate, quantile(pyruvate, probs=seq(0,1,0.5)), c(\"Below Median\", \"Above Median\"))) %&gt;% #ifelse(pyruvate &gt; median(pyruvate, na.rm = T), \"Above Median\", \"Below Median\")) %&gt;%\n  mutate(tt_os_months = tt_os_d/30.44) %&gt;%\n  mutate(tt_pfs_months = tt_pfs_d/30.44) %&gt;%\n  arrange(med_p)\n\nfit&lt;- survfit(Surv(tt_os_months, event_os) ~ med_p, data = acoa_df)\nnames(fit$strata) &lt;- gsub(\"med_p=\", \"\", names(fit$strata))\np &lt;- ggsurvplot(fit,  size = 1,  # change line size\n           linetype = \"solid\", # use solid line\n           break.time.by = 12, # break time axis by 12 months\n           palette = c(\"aquamarine4\", \"coral4\"), # custom color palette\n           conf.int = TRUE, # Add confidence interval\n           pval = TRUE, # Add p-value,\n           legend.title=\"\",\n           risk.table = TRUE, risk.table.y.text.col = TRUE,\n           ylab = \"Survival %\",\n           xlab = \"Time (Months)\",\n           xlim = c(0,48)\n           ) \nprint(p)\n\n\n\n\n\n\n\n#g_to_save &lt;- ggsave_survival_workaround(p)\n#ggsave(file=\"survival_lachno_clostr_years.svg\", plot=g_to_save, width=10, height=8)\n\nSame plot but looking at PFS instead of OS:\n\nfit&lt;- survfit(Surv(tt_pfs_months, pfs_event) ~ med_p, data = acoa_df)\nnames(fit$strata) &lt;- gsub(\"med_p=\", \"\", names(fit$strata))\np &lt;- ggsurvplot(fit,  size = 1,  # change line size\n           linetype = \"solid\", # use solid line\n           break.time.by = 12, # break time axis by 12 months\n           palette = c(\"coral4\", \"aquamarine4\"), # custom color palette\n           conf.int = TRUE, # Add confidence interval\n           pval = TRUE, # Add p-value,\n           legend.title=\"\",\n           risk.table = TRUE, risk.table.y.text.col = TRUE,\n           ylab = \"Survival %\",\n           xlab = \"Time (Months)\",\n           xlim = c(0,48),\n           ggtheme = theme_classic() + theme(aspect.ratio = 1),\n           tables.theme =  theme(aspect.ratio = 0.2)\n           ) \nprint(p)\n\n\n\n\n\n\n\n#g_to_save &lt;- ggsave_survival_workaround(p)\n#ggsave(file=\"survival_lachno_clostr_years.svg\", plot=g_to_save, width=10, height=8)\n\n\n\nPanel B\nRestricted cubic spline, adjusted for age, diagnosis and performance with above/below median pathway abundance.\n\nmodel_spline_os &lt;- coxph(Surv(tt_os_d, event_os) ~ rms::rcs(pyruvate,4) + age10 + factor(cohort) + ecog, acoa_df)\nptemp &lt;- termplot(model_spline_os, se=T, plot=F)\nbuterm &lt;- ptemp$pyruvate\ncenter &lt;- buterm$y[which(buterm$y == median(buterm$y))]\nytemp &lt;- buterm$y + outer(buterm$se, c(0, -1.96, 1.96), '*')\nexp_ytemp &lt;- exp(ytemp - center)\n\nspline_data &lt;- data.frame(buty = buterm$x, Estimate = exp_ytemp[,1],\n                          Lower = exp_ytemp[,2], Upper = exp_ytemp[,3])\n\nggplot(spline_data, aes(x = buty)) +\n  geom_ribbon(aes(ymin = Lower, ymax = Upper), fill = \"grey80\", alpha = 0.5) +\n  geom_line(aes(y = Estimate), color = \"blue\") +\n  geom_rug(sides = \"b\") +  # Add rug plot at the bottom ('b') of the plot\n  scale_y_log10() +  # Log scale for y-axis\n  labs(x = \"Pyruvate-pathway genes present\", y = \"Hazard ratio\") +\n  theme_minimal()"
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#taxonomy-breakdown-plots",
    "href": "figure_2_acoa_pathway_icb_outcome.html#taxonomy-breakdown-plots",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Taxonomy breakdown plots:",
    "text": "Taxonomy breakdown plots:\nWe will now plot some microbiome data, using a phyloseq object that contains our sequencing data. This object contains a list of the taxonomy of organisms identified, the abundance in each sample, and any associated sample specific metadata in one object.\n\nPanel C\nPCoA shows relationship between ACoA pathways gene abundance and PCA axes.\n\nps &lt;- readRDS(\"../data/cleaned_data/plotting_phyloseq.rds\")\n\nps %&gt;%\n  ps_filter(SAMPID %in% acoa_df$SAMPID) %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Family\") %&gt;%\n  ord_calc(\"PCA\") %&gt;%\n  ord_plot(fill = \"log_acoa\", size = 4, shape=21, alpha=0.6,\n           plot_taxa = c(\"Lachnospiraceae\", \"Bacteroidales_order\", \"Ruminococcaceae\")) +\n  scale_fill_viridis(option=\"B\", begin = 0, end=1) +\n  theme_classic() + \n  xlim(c(-.25, .75)) +\n  ylim(c(-.3, .6))"
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#panel-d",
    "href": "figure_2_acoa_pathway_icb_outcome.html#panel-d",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Panel D",
    "text": "Panel D\nACoA pathway abundance vs relative abundance of Lachnospiraceae and Reuminococcaceae\n\n# We will take the information we need out the phyloseq, and convert it to a dataframe for plotting: \ncompare_family &lt;- ps %&gt;% \n  get.otu.melt() %&gt;%\n  group_by(SAMPID, Family) %&gt;%\n  summarise(total_family = sum(pctseqs)) %&gt;%\n  left_join(acoa_df %&gt;% select(SAMPID, `pyruvate`))\n\ncompare_family %&gt;%\n  filter(Family == \"Lachnospiraceae\") %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=pyruvate, y=total_family), method=lm, color=\"steelblue\") +\n  geom_point(aes(x=pyruvate, y=total_family),\n             shape=21, size=3, fill=\"steelblue\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Lachnospiraceae\"\n  )\n\n\n\n\n\n\n\n\n\ncompare_family %&gt;%\n  filter(Family == \"Ruminococcaceae\") %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=pyruvate, y=total_family), method=lm, color=\"darkgoldenrod3\") +\n  geom_point(aes(x=pyruvate, y=total_family),\n             shape=21, size=3, fill=\"darkgoldenrod3\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Lachnospiraceae\"\n  )"
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#panel-e",
    "href": "figure_2_acoa_pathway_icb_outcome.html#panel-e",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Panel E",
    "text": "Panel E\nUnivariate Cox regression analyses PFS relationship to ACoA gene abundance in external cohort."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html",
    "href": "figure_1_hazard_ratio_fiber.html",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "",
    "text": "The data we are visualizing here has the following structure:"
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-a",
    "href": "figure_1_hazard_ratio_fiber.html#panel-a",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel A",
    "text": "Panel A\nMortality Hazard for PFS by daily average fiber intake, visualized via partial smoothing spline. Ticks along the x axis represent individual patients."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-b",
    "href": "figure_1_hazard_ratio_fiber.html#panel-b",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel B",
    "text": "Panel B\nMortality Hazard for OS by daily average fiber intake, visualized via partial smoothing spline. Ticks along the x axis represent individual patients."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-c",
    "href": "figure_1_hazard_ratio_fiber.html#panel-c",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel C",
    "text": "Panel C\nKaplan-Meier PFS by daily average fiber intake, two groups &gt;= 15 grams/day."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-d",
    "href": "figure_1_hazard_ratio_fiber.html#panel-d",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel D",
    "text": "Panel D\nKaplan-Meier OS by daily average fiber intake, two groups &gt;= 15 grams/day."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-e",
    "href": "figure_1_hazard_ratio_fiber.html#panel-e",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel E",
    "text": "Panel E\nUnivariate HRs for PFS among clinically relavant subgroups."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-f",
    "href": "figure_1_hazard_ratio_fiber.html#panel-f",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel F",
    "text": "Panel F\nMultivariate HR for PFS adjusted for age, diagnosis, and performance status."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": ".",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  }
]