[
  {
    "objectID": "shortbred_analysis_intro.html",
    "href": "shortbred_analysis_intro.html",
    "title": " ShortBRED Analysis.",
    "section": "",
    "text": "ShortBRED is a tool developed by the Huttenhower group for profiling specific protein families of interest using shotgun metagenomic data. Here is an image taken from their paper* explaining the process:\n\nIn this project it was used to profile genes involved in butyrate synthesis using a set of genes identified by Vital et al in their paper Revealing the Bacterial Butyrate Synthesis Pathways by Analyzing (Meta)genomic Data.\nGenes used in this analysis were downloaded from the Integrated Microbial Genomes and Microbiomes database. A fastq file which acted as our ShortBRED database for this analysis is included in the Github repo for this project.\n\n\nTo run the example of this shortBRED code on one of the fastqs from this project:\nNote butyrate_pw_genes_aa_seqs.fa is the fasta file we used to build the ShortBRED marker db. We also provide you with the pre-built marker db: butyrate_pw_genes_markers.fa",
    "crumbs": [
      "Analysis Notes",
      "shortBRED Analysis Butyrate Gene Quantification"
    ]
  },
  {
    "objectID": "shortbred_analysis_intro.html#what-is-shortbred-and-what-did-we-use-it-for",
    "href": "shortbred_analysis_intro.html#what-is-shortbred-and-what-did-we-use-it-for",
    "title": " ShortBRED Analysis.",
    "section": "",
    "text": "ShortBRED is a tool developed by the Huttenhower group for profiling specific protein families of interest using shotgun metagenomic data. Here is an image taken from their paper* explaining the process:\n\nIn this project it was used to profile genes involved in butyrate synthesis using a set of genes identified by Vital et al in their paper Revealing the Bacterial Butyrate Synthesis Pathways by Analyzing (Meta)genomic Data.\nGenes used in this analysis were downloaded from the Integrated Microbial Genomes and Microbiomes database. A fastq file which acted as our ShortBRED database for this analysis is included in the Github repo for this project.\n\n\nTo run the example of this shortBRED code on one of the fastqs from this project:\nNote butyrate_pw_genes_aa_seqs.fa is the fasta file we used to build the ShortBRED marker db. We also provide you with the pre-built marker db: butyrate_pw_genes_markers.fa",
    "crumbs": [
      "Analysis Notes",
      "shortBRED Analysis Butyrate Gene Quantification"
    ]
  },
  {
    "objectID": "shortbred_analysis_intro.html#analysis-setup",
    "href": "shortbred_analysis_intro.html#analysis-setup",
    "title": " ShortBRED Analysis.",
    "section": "Analysis setup:",
    "text": "Analysis setup:\n\nInstall dependencies:\n(Note that we primarily use the SSH links for git clone. The HTTPS git clone commands are also provided in paranthesis)\n\nClone this repo to a machine with your raw data where you plan to do your analysis.\n\ngit clone git@github.com:mskcc-microbiome/butyrate_and_icb_2025.git (git clone https://github.com/mskcc-microbiome/butyrate_and_icb_2025.git)\n\nInstall usearch (just need v6.0.307 or later, we use v 11.0.667):\n\ncurl https://www.drive5.com/downloads/usearch11.0.667_i86linux32.gz --output usearch11.0.667_i86linux32.gz\ngunzip usearch11.0.667_i86linux32.gz\nNote: make sure you change the permissions if needed so that you have the rights to execute this file (chmod u+x usearch11.0.667_i86linux32)\n\nInstall Shortbred\n\ngit clone git@github.com:biobakery/shortbred.git (git clone https://github.com/biobakery/shortbred.git)",
    "crumbs": [
      "Analysis Notes",
      "shortBRED Analysis Butyrate Gene Quantification"
    ]
  },
  {
    "objectID": "shortbred_analysis_intro.html#analysis-options",
    "href": "shortbred_analysis_intro.html#analysis-options",
    "title": " ShortBRED Analysis.",
    "section": "Analysis Options:",
    "text": "Analysis Options:\n\nBash script (easiest to get up and going):\n\nSet up Environment:\nFirst create and activate an environment with the correct installed packages:\nFrom the base dir of this repo:\nmamba env create -n shortbred_env -f data_processing/shortbred_analysis/envs/shortbred_env.yaml \nmamba activate shortbred_env\nMake sure this env is activated whenever you run this shortbred analysis!\n\n\nUpdate Config\nNow open data_processing/shortbred_analysis/config_params.sh and edit the following variables:\n\nUSEARCH - this should be the path to usearch that you installed in Analysis setup\nMARKER_FASTQ - this is the marker fastq we supplied for this analysis! Location: data_processing/shortbred_analysis/butyrate_pw_genes_markers.fa\nQUANTIFY_SCRIPT - the path to the shortbred_quantify.py script in your Shortbred installation.\n\n\n\nTest Run (recommended)\nSave data_processing/shortbred_analysis/shortbred_template.sh with a new name ie cp data_processing/shortbred_analysis/shortbred_template.sh data_processing/shortbred_analysis/shortbred_test_run.sh.\nEdit the header to add job specific details (note we use LSF headers, please update to whatever submission manager you use!)\n\n#BSUB -J -&gt; #BSUB -J test_shortbred_run\n#BSUB -o -&gt; #BSUB -o test_shortbred_run.stdout\n#BSUB -eo -&gt; #BSUB -eo test_shortbred_run.stderr\n#BSUB -n -&gt; #BSUB -n 1 (for example, can do more than this too, and set the threads parameter below to match.)\n\nManually edit the following parameters:\n\ninput: the fastq.gz file you are running your analysis on.\noutput: desired output file. ie: {$sample_name}_butyrate.txt”.\ntmp_dir: name of a temporary directory this analysis can use while running. (ie {$sample_name}_shortbred_tmp)\nthreads: treads used in test (can default to 1 if needed).\n\nsubmit the job!\nsh data_processing/shortbred_analysis/shortbred_test_run.sh or if submitting as a LSF job: bsub &lt; data_processing/shortbred_analysis/shortbred_test_run.sh.\n\n\nSubmit a list of jobs:\nGiven a folder of fastq.gz files, run a job to submit the shortbred analysis on all of them. We wrote an example script for doing this here:\ndata_processing/shortbred_analysis/shortbred_run_on_folder_example.sh\nYou may need to modify this for your exact use case.\nTo run it, modify the dir\n\n\n\nSnakemake:\nUsing the Snakefile in this folder you should be able to run this file locally or on an HPC. If you use LSF we have a Snakemake profile you can use for submissions.\nShortBRED has the following environmental requirements: - Python 2.7.9 - Biopython v1.65 - ncbi-blast-2.2.28+ - usearch v6.0.307 (Please make sure this is up to date. Earlier versions of usearch use a different command for making database than what is expected by ShortBRED.) - MUSCLE v3.8.31 - CD-HIT version 4.6\nThese environmental requirements are captured in the shortbred_env.yaml file used by the Snakefile for ShortBRED analysis.\nOur analysis currently assumes a structure where each sample has a directory containing R1 and R2 as fastq.gz files. The sample_dir and sample name will be provided as dynamic entries to the config.\nYou will also need to update the config file for the snakemake workflow for the following parameters: - quantify_script: (the path to the shortBRED quantify_script) - marker_fastq: (path to the marker fastq we provided (or updated marker.fastq if using your own reference)). - usearch: the path to your usearch installation.\n\nTest files:\n\nDownload a test file, ie: one of the fastqs from our paper\n\n\n\nCitations:\n\nKaminski J, Gibson MK, Franzosa EA, Segata N, Dantas G, Huttenhower C (2015) High-Specificity Targeted Functional Profiling in Microbial Communities with ShortBRED. PLoS Comput Biol 11(12): e1004557.",
    "crumbs": [
      "Analysis Notes",
      "shortBRED Analysis Butyrate Gene Quantification"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Butyrate, the Microbiome and ICB Therapy",
    "section": "",
    "text": "This site is dedicated to the corresponding manuscript: “Dietary fiber intake and gut microbial fiber fermentation capacity are associated with favorable clinical outcomes following immune checkpoint blockade”\nWhere possible code has been written so that it can be executed from this repository. However there are certain types of data we are not able to make public. Cells which rely on private data will be marked as not executable, however, even in cases where the data is not public all to code used to generate figures is here.\nThis is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html",
    "href": "figure_1_hazard_ratio_fiber.html",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "",
    "text": "The data we are visualizing here has the following structure:",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-b",
    "href": "figure_1_hazard_ratio_fiber.html#panel-b",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel B",
    "text": "Panel B\nMortality Hazard for PFS by daily average fiber intake, visualized via partial smoothing spline. Ticks along the x axis represent individual patients.\n\nmakeSpline(all_metadata_fiber, all_metadata_fiber$pfs_mo, all_metadata_fiber$pod_status, \n           all_metadata_fiber$aofib,\n           xlab = \"Daily average fiber intake (g/day)\", ylab=\"Hazard ratio (95% CI)\",\n           title=\"Smoothing spline for progression-free survival\",\n           knots=2,\n           centerpoint = 15)+\n  scale_x_log10()",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-c",
    "href": "figure_1_hazard_ratio_fiber.html#panel-c",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel C",
    "text": "Panel C\nMortality Hazard for OS by daily average fiber intake, visualized via partial smoothing spline. Ticks along the x axis represent individual patients.\n\nmakeSpline(all_metadata_fiber, all_metadata_fiber$os_mo, all_metadata_fiber$os_status, \n           all_metadata_fiber$aofib,\n           xlab = \"Daily average fiber intake (g/day)\", ylab=\"Hazard ratio (95% CI)\",\n           title=\"Smoothing spline for overall survival\",\n           knots=2, \n           centerpoint = 15) +\n  scale_x_log10()",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-d",
    "href": "figure_1_hazard_ratio_fiber.html#panel-d",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel D",
    "text": "Panel D\nKaplan-Meier PFS by daily average fiber intake, two groups &gt;= 15 grams/day.\n\nkmPFS&lt;-survfit(Surv(pfs_mo, pod_status)~fiber_dichotomized,\n               type=\"kaplan-meier\", data=all_metadata_fiber)\n\nggsurvplot(kmPFS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Progression-free survival\",\n           pval = TRUE,\n           legend=c(0.8,0.9),\n           title=\"Patients with urothelial or renal cell cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           xlim=c(0,25),\n           data = all_metadata_fiber)",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-e",
    "href": "figure_1_hazard_ratio_fiber.html#panel-e",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel E",
    "text": "Panel E\nKaplan-Meier OS by daily average fiber intake, two groups &gt;= 15 grams/day.\n\nkmOS&lt;-survfit(Surv(os_mo, os_status)~fiber_dichotomized,\n              type=\"kaplan-meier\", data=all_metadata_fiber)\n\nggsurvplot(kmOS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Overall survival\",\n           pval = TRUE,\n           legend=\"none\",\n           title=\"Patients with urothelial or renal cell cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           xlim=c(0,25),\n           data = all_metadata_fiber)",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-f",
    "href": "figure_1_hazard_ratio_fiber.html#panel-f",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel F",
    "text": "Panel F\nUnivariate HRs for PFS among clinically relavant subgroups.\n\ncox_pfs_all_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                       all_metadata_fiber)\nsummary(cox_pfs_all_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                      coef exp(coef) se(coef)  z Pr(&gt;|z|)   \nfiber_dichotomized -0.8190    0.4409   0.2730 -3   0.0027 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.4409      2.268    0.2582    0.7528\n\nConcordance= 0.609  (se = 0.032 )\nLikelihood ratio test= 8.47  on 1 df,   p=0.004\nWald test            = 9  on 1 df,   p=0.003\nScore (logrank) test = 9.49  on 1 df,   p=0.002\n\ncox_pfs_RC &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                   mRCdataFiber)\nsummary(cox_pfs_RC)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = mRCdataFiber)\n\n  n= 48, number of events= 28 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized -1.0541    0.3485   0.3945 -2.672  0.00754 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.3485      2.869    0.1608    0.7551\n\nConcordance= 0.641  (se = 0.046 )\nLikelihood ratio test= 6.46  on 1 df,   p=0.01\nWald test            = 7.14  on 1 df,   p=0.008\nScore (logrank) test = 7.8  on 1 df,   p=0.005\n\ncox_pfs_RC_IpiNivo &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                           dataRCIpiNivoFiber)\nsummary(cox_pfs_RC_IpiNivo)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = dataRCIpiNivoFiber)\n\n  n= 15, number of events= 8 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -0.7864    0.4555   0.7387 -1.065    0.287\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.4555      2.196    0.1071     1.937\n\nConcordance= 0.627  (se = 0.094 )\nLikelihood ratio test= 1.04  on 1 df,   p=0.3\nWald test            = 1.13  on 1 df,   p=0.3\nScore (logrank) test = 1.19  on 1 df,   p=0.3\n\ncox_pfs_RC_TKI_IO &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                          dataRCioTKIFiber)\nsummary(cox_pfs_RC_TKI_IO)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = dataRCioTKIFiber)\n\n  n= 24, number of events= 12 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized -1.1926    0.3034   0.6183 -1.929   0.0538 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.3034      3.295   0.09031      1.02\n\nConcordance= 0.635  (se = 0.073 )\nLikelihood ratio test= 3.16  on 1 df,   p=0.08\nWald test            = 3.72  on 1 df,   p=0.05\nScore (logrank) test = 4.17  on 1 df,   p=0.04\n\ncox_pfs_UC &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                   mUCdataFiber)\nsummary(cox_pfs_UC)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = mUCdataFiber)\n\n  n= 40, number of events= 29 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -0.3570    0.6998   0.3787 -0.943    0.346\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.6998      1.429    0.3332      1.47\n\nConcordance= 0.539  (se = 0.05 )\nLikelihood ratio test= 0.87  on 1 df,   p=0.3\nWald test            = 0.89  on 1 df,   p=0.3\nScore (logrank) test = 0.9  on 1 df,   p=0.3\n\ncox_pfs_UC_NOTavelumab &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                               dataUC_NOTavelumab)\nsummary(cox_pfs_UC_NOTavelumab)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = dataUC_NOTavelumab)\n\n  n= 26, number of events= 21 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -0.1107    0.8952   0.4417 -0.251    0.802\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.8952      1.117    0.3767     2.128\n\nConcordance= 0.491  (se = 0.067 )\nLikelihood ratio test= 0.06  on 1 df,   p=0.8\nWald test            = 0.06  on 1 df,   p=0.8\nScore (logrank) test = 0.06  on 1 df,   p=0.8\n\ncox_pfs_UC_avelumab &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized,\n                            dataUCavelumab)\nsummary(cox_pfs_UC_avelumab)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized, \n    data = dataUCavelumab)\n\n  n= 14, number of events= 8 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -0.1060    0.8994   0.8239 -0.129    0.898\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.8994      1.112    0.1789     4.521\n\nConcordance= 0.527  (se = 0.091 )\nLikelihood ratio test= 0.02  on 1 df,   p=0.9\nWald test            = 0.02  on 1 df,   p=0.9\nScore (logrank) test = 0.02  on 1 df,   p=0.9\n\nforestplot_data &lt;- tibble::tibble(mean  = c(0.4409,0.3485, 0.4555, 0.3034, 0.6998, 0.8952, 0.8994),\n                                  lower = c(0.2582,0.1608, 0.1071, 0.09031, 0.3332, 0.3767, 0.1789),\n                                  upper = c(0.7528,0.7551, 1.937, 1.02, 1.47, 2.128, 4.521),\n                                  study = c(\"All\",\"RCC\", \"RCC ipi-nivo\", \"RCC TKI-ICB\",\n                                            \"UC\", \"UC non-maintenance ICB\", \"UC maintenance ICB\"),\n                                  n = c(\"88\",\"48\",\"15\",\"24\",\"40\",\"26\",\"14\"),\n                                  events = c(\"57\",\"28\",\"8\",\"12\",\"29\",\"21\",\"8\"),\n                                  HR = c(\"0.44\",\"0.35\", \"0.46\", \"0.30\", \"0.70\", \"0.90\", \"0.90\"))\n\nforestplot_data |&gt;\n  forestplot(labeltext = c(study, n, events, HR),\n             clip = c(0.09, 2.5),\n             xlog = TRUE,\n             xlab = \"Hazard ratio for PFS (95% CI)\",\n             xticks = c(0.1,0.25,0.5,1.0,2.5),\n             title = \"Univariable progression-free survival subgroup analyis\") |&gt;\n  fp_set_style(box = \"royalblue\",\n               line = \"darkblue\",\n               summary = \"royalblue\") |&gt; \n  fp_add_header(study = c(\"Subgroup\"),\n                n = c(\"n\"),\n                events = c(\"Events\"),\n                HR = c(\"HR\"))",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "figure_1_hazard_ratio_fiber.html#panel-g",
    "href": "figure_1_hazard_ratio_fiber.html#panel-g",
    "title": " Figure 1 - Hazard Ratio Analysis of Fiber Intake",
    "section": "Panel G",
    "text": "Panel G\nMultivariate HR for PFS adjusted for age, diagnosis, and performance status.\n\ncox_pfs_all &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized + ageby10 + ecog_1to5_final,\n                    all_metadata_fiber)\nsummary(cox_pfs_all)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized -0.9038    0.4050   0.2891 -3.126  0.00177 **\nageby10             0.3582    1.4308   0.1376  2.604  0.00922 **\necog_1to5_final     0.3765    1.4571   0.3301  1.140  0.25417   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized     0.405     2.4690    0.2298    0.7138\nageby10                1.431     0.6989    1.0926    1.8737\necog_1to5_final        1.457     0.6863    0.7629    2.7830\n\nConcordance= 0.659  (se = 0.041 )\nLikelihood ratio test= 18.25  on 3 df,   p=4e-04\nWald test            = 17.7  on 3 df,   p=5e-04\nScore (logrank) test = 18.41  on 3 df,   p=4e-04\n\ncox_pfs_RC &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized + ageby10 + ecog_1to5_final,\n                   mRCdataFiber)\nsummary(cox_pfs_RC)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = mRCdataFiber)\n\n  n= 48, number of events= 28 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized -1.1441    0.3185   0.4488 -2.549  0.01079 * \nageby10             0.5361    1.7093   0.2011  2.666  0.00769 **\necog_1to5_final     0.5315    1.7015   0.4766  1.115  0.26483   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.3185     3.1396    0.1322    0.7676\nageby10               1.7093     0.5850    1.1525    2.5352\necog_1to5_final       1.7015     0.5877    0.6685    4.3306\n\nConcordance= 0.727  (se = 0.048 )\nLikelihood ratio test= 15.03  on 3 df,   p=0.002\nWald test            = 15.1  on 3 df,   p=0.002\nScore (logrank) test = 16.22  on 3 df,   p=0.001\n\ncox_pfs_RC_IpiNivo &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized+ ageby10 + ecog_1to5_final,\n                           dataRCIpiNivoFiber)\nsummary(cox_pfs_RC_IpiNivo)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = dataRCIpiNivoFiber)\n\n  n= 15, number of events= 8 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized -1.9978    0.1356   1.0827 -1.845   0.0650 .\nageby10             1.6818    5.3750   0.7495  2.244   0.0248 *\necog_1to5_final     0.4927    1.6367   0.9073  0.543   0.5871  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.1356      7.373   0.01625     1.132\nageby10               5.3750      0.186   1.23717    23.352\necog_1to5_final       1.6367      0.611   0.27651     9.688\n\nConcordance= 0.81  (se = 0.092 )\nLikelihood ratio test= 8.69  on 3 df,   p=0.03\nWald test            = 5.88  on 3 df,   p=0.1\nScore (logrank) test = 7.16  on 3 df,   p=0.07\n\ncox_pfs_RC_TKI_IO &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized+ ageby10 + ecog_1to5_final,\n                          dataRCioTKIFiber)\nsummary(cox_pfs_RC_TKI_IO)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = dataRCioTKIFiber)\n\n  n= 24, number of events= 12 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized -0.5312    0.5879   0.7341 -0.724   0.4693  \nageby10             0.3140    1.3689   0.4844  0.648   0.5168  \necog_1to5_final     1.8411    6.3036   0.8549  2.154   0.0313 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.5879     1.7009    0.1395     2.479\nageby10               1.3689     0.7305    0.5297     3.538\necog_1to5_final       6.3036     0.1586    1.1801    33.671\n\nConcordance= 0.754  (se = 0.066 )\nLikelihood ratio test= 9.31  on 3 df,   p=0.03\nWald test            = 6.94  on 3 df,   p=0.07\nScore (logrank) test = 9.12  on 3 df,   p=0.03\n\ncox_pfs_UC &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized+ ageby10 + ecog_1to5_final,\n                   mUCdataFiber)\nsummary(cox_pfs_UC)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = mUCdataFiber)\n\n  n= 40, number of events= 29 \n\n                       coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -0.42328   0.65490  0.39185 -1.080    0.280\nageby10             0.15310   1.16544  0.18707  0.818    0.413\necog_1to5_final    -0.05191   0.94942  0.49855 -0.104    0.917\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.6549      1.527    0.3038     1.412\nageby10               1.1654      0.858    0.8077     1.682\necog_1to5_final       0.9494      1.053    0.3573     2.522\n\nConcordance= 0.537  (se = 0.07 )\nLikelihood ratio test= 1.61  on 3 df,   p=0.7\nWald test            = 1.54  on 3 df,   p=0.7\nScore (logrank) test = 1.56  on 3 df,   p=0.7\n\ncox_pfs_UC_NOTavelumab &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized+ ageby10 + ecog_1to5_final,\n                               dataUC_NOTavelumabFiber)\nsummary(cox_pfs_UC_NOTavelumab)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = dataUC_NOTavelumabFiber)\n\n  n= 26, number of events= 21 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized  0.3584    1.4311   0.5299  0.676    0.499\nageby10            -0.1427    0.8670   0.2760 -0.517    0.605\necog_1to5_final    -1.0023    0.3670   0.6821 -1.469    0.142\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized     1.431     0.6988   0.50655     4.043\nageby10                0.867     1.1534   0.50474     1.489\necog_1to5_final        0.367     2.7245   0.09641     1.397\n\nConcordance= 0.634  (se = 0.069 )\nLikelihood ratio test= 3.95  on 3 df,   p=0.3\nWald test            = 4.34  on 3 df,   p=0.2\nScore (logrank) test = 4.68  on 3 df,   p=0.2\n\ncox_pfs_UC_avelumab &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized+ ageby10 + ecog_1to5_final,\n                            dataUCavelumabFiber)\nsummary(cox_pfs_UC_avelumab)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final, data = dataUCavelumabFiber)\n\n  n= 14, number of events= 8 \n\n                         coef  exp(coef)   se(coef)      z Pr(&gt;|z|)\nfiber_dichotomized -4.907e-01  6.122e-01  9.281e-01 -0.529    0.597\nageby10             3.708e-01  1.449e+00  3.681e-01  1.007    0.314\necog_1to5_final     2.028e+01  6.449e+08  1.626e+04  0.001    0.999\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized 6.122e-01  1.633e+00   0.09928     3.775\nageby10            1.449e+00  6.902e-01   0.70419     2.981\necog_1to5_final    6.449e+08  1.551e-09   0.00000       Inf\n\nConcordance= 0.662  (se = 0.124 )\nLikelihood ratio test= 6.44  on 3 df,   p=0.09\nWald test            = 1.02  on 3 df,   p=0.8\nScore (logrank) test = 4.05  on 3 df,   p=0.3\n\nforestplot_data &lt;- tibble::tibble(mean  = c(0.405, 0.3185, 0.6549),\n                                  lower = c(0.2298, 0.1322, 0.3038),\n                                  upper = c(0.7138, 0.7676, 1.412),\n                                  study = c(\"All\", \"RCC\", \"UC\"),\n                                  n = c(\"88\",\"48\",\"40\"),\n                                  events = c(\"57\",\"28\",\"29\"),\n                                  HR = c(\"0.41\",\"0.32\",\"0.65\"))\n\nforestplot_data |&gt;\n  forestplot(labeltext = c(study, n, events, HR),\n             clip = c(0.09, 2.5),\n             xlog = TRUE,\n             xlab = \"Hazard ratio for PFS (95% CI)\",\n             xticks = c(0.1,0.25,0.5,1.0,2.5),\n             title = \"Multivariable progression-free survival subgroup analyis\") |&gt;\n  fp_set_style(box = \"royalblue\",\n               line = \"darkblue\",\n               summary = \"royalblue\") |&gt; \n  fp_add_header(study = c(\"Subgroup\"),\n                n = c(\"n\"),\n                events = c(\"Events\"),\n                HR = c(\"HR\"))",
    "crumbs": [
      "Main Figures",
      "Figure 1: Hazard Ratio with Fiber"
    ]
  },
  {
    "objectID": "extended_data_figure_3_butyrate_genes_overall_survival.html",
    "href": "extended_data_figure_3_butyrate_genes_overall_survival.html",
    "title": " Extended Figure 3 Gene Abundance and Hazard Ration, and Univatiate Analysis of Butyrate Pathway.",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.\n[1] \"blinded_subject_id\"    \"id_int\"                \"cohort\"               \n [4] \"age\"                   \"impact_tmb_score\"      \"cpb_drug\"             \n [7] \"ecog\"                  \"best_overall_response\" \"tt_pfs_d\"             \n[10] \"pfs_event\"             \"tt_os_d\"               \"event_os\"             \n[13] \"TMPT\"                  \"WMS_SGPID\"             \"SAMPID\"               \n[16] \"total\"                 \"samp_id\"               \"identifier.y\"         \n[19] \"Shannon\"               \"tx\"                    \"age10\"                \n[22] \"med_buty\"              \"fouraminobutyrate\"     \"gluatarate\"           \n[25] \"lysine\"                \"pyruvate\"",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 3: Butyrate Genes and OS"
    ]
  },
  {
    "objectID": "extended_data_figure_3_butyrate_genes_overall_survival.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "href": "extended_data_figure_3_butyrate_genes_overall_survival.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "title": " Extended Figure 3 Gene Abundance and Hazard Ration, and Univatiate Analysis of Butyrate Pathway.",
    "section": "Survival plots as a function of pyruvate gene abundance:",
    "text": "Survival plots as a function of pyruvate gene abundance:\n\nPanel A\n\nHazard Ratio of Overall Survival Evaluated with respect to Butyrate production gene RPKM.\n\nos_butyrate &lt;-  coxph(Surv(tt_os_d, event_os)~rms::rcs(total,4)+age10+factor(cohort)+ecog,, data = acoa_df)\nptemp &lt;- termplot(os_butyrate, se=T, plot=F)\nbuterm &lt;- ptemp$total\ncenter &lt;- buterm$y[which(buterm$y == median(buterm$y))]\nytemp &lt;- buterm$y + outer(buterm$se, c(0, -1.96, 1.96), '*')\nexp_ytemp &lt;- exp(ytemp - center)\n\nspline_data &lt;- data.frame(buty = buterm$x, Estimate = exp_ytemp[,1],\n                          Lower = exp_ytemp[,2], Upper = exp_ytemp[,3])\n\nggplot(spline_data, aes(x = buty)) +\n  geom_ribbon(aes(ymin = Lower, ymax = Upper), fill = \"grey80\", alpha = 0.5) +\n  geom_line(aes(y = Estimate), color = \"blue\") +\n  geom_rug(sides = \"b\") +  # Add rug plot at the bottom ('b') of the plot\n  scale_y_log10() +  # Log scale for y-axis\n  labs(x = \"Total butyrate-pathway genes present\", y = \"Hazard ratio\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nPanel B\n\nUnivariate model of OS as a function of total butyrate genes, and each major sub-pathway in the butyrate production gene pathways.\n\nuniv2 &lt;- function(cox, k=1, l=1){\n  coef &lt;- exp(coef(cox))\n  confint &lt;- exp(confint(cox))\n  p &lt;- summary(cox)$coefficients[,5]\n  out &lt;- data.frame(\"HR\"=round(coef,4), round(confint,4), \"p\"=round(p,9))\n  q &lt;- nrow(out)\n  if(l== -1){out &lt;- out[q,]\n  }else{out &lt;- out[k:l,]}\n  return(out)\n\n}\n\nforest_os &lt;- rbind(\nuniv2(coxph(Surv(tt_os_d, event_os)~log(total)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(pyruvate)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(lysine+0.0000001)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(fouraminobutyrate+0.000001)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(gluatarate+0.000001)+age10+cohort+ecog, acoa_df)))\n\nforest_os %&gt;%\n  rename_with(~ c(\"HR\", \"CI_low\", \"CI_high\", \"p\"), .cols = everything()) %&gt;%\n  rownames_to_column(\"scfa\") %&gt;%\n  ggplot() +\n  geom_vline(xintercept=1, lty=2, size=0.25)+\n  geom_point(aes(x=HR, y=fct_reorder(scfa, HR, .desc = T)))+\n  geom_linerange(aes(xmin=CI_low, xmax=CI_high, y=fct_reorder(scfa, HR)), size=0.5) +\n  scale_x_continuous(transform = \"log\", breaks=round(exp(seq(-2,1.5,0.5)),1)) +\n  theme_classic() +\n  coord_cartesian(xlim=exp(c(-2, 0.3))) + \n  labs(y = \"\")",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 3: Butyrate Genes and OS"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "extended_data_figure_2_pfs_fiber_disease_type.html",
    "href": "extended_data_figure_2_pfs_fiber_disease_type.html",
    "title": " Extended Figure 2: PFS vs Fiber by Disease Type",
    "section": "",
    "text": "The data we are visualizing here has the following structure:",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 2: PFS Fiber by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_2_pfs_fiber_disease_type.html#panel-a",
    "href": "extended_data_figure_2_pfs_fiber_disease_type.html#panel-a",
    "title": " Extended Figure 2: PFS vs Fiber by Disease Type",
    "section": "Panel A",
    "text": "Panel A\nMortality Hazard for PFS by daily average fiber intake, visualized via partial smoothing spline. Ticks along the x axis represent individual patients.\n\ncox_pfs_allMet_mv &lt;-coxph(Surv(pfs_mo,\n                               pod_status)~ fiber_dichotomized + \n                            ageby10 + \n                            ecog_1to5_final +\n                            cancer_RCCvsUC_NAME,\n                          all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized    -0.8237    0.4388   0.2917 -2.824  0.00475 **\nageby10                0.3010    1.3511   0.1422  2.117  0.03426 * \necog_1to5_final        0.3214    1.3790   0.3315  0.970  0.33227   \ncancer_RCCvsUC_NAMEUC  0.4412    1.5545   0.2914  1.514  0.13006   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4388     2.2790    0.2477    0.7772\nageby10                  1.3511     0.7401    1.0226    1.7853\necog_1to5_final          1.3790     0.7251    0.7202    2.6407\ncancer_RCCvsUC_NAMEUC    1.5545     0.6433    0.8781    2.7520\n\nConcordance= 0.676  (se = 0.036 )\nLikelihood ratio test= 20.55  on 4 df,   p=4e-04\nWald test            = 20.05  on 4 df,   p=5e-04\nScore (logrank) test = 21.25  on 4 df,   p=3e-04\n\ncox_pfs_allMet_mv2 &lt;-coxph(Surv(pfs_mo,\n                                pod_status)~ fiber_dichotomized + \n                             calor +\n                             ageby10 + \n                             ecog_1to5_final +\n                             cancer_RCCvsUC_NAME,\n                           all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv2)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    calor + ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, \n    data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                            coef  exp(coef)   se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized    -0.7247475  0.4844469  0.3636819 -1.993   0.0463 *\ncalor                 -0.0001182  0.9998818  0.0002659 -0.445   0.6566  \nageby10                0.2964480  1.3450727  0.1416315  2.093   0.0363 *\necog_1to5_final        0.3283082  1.3886169  0.3321438  0.988   0.3229  \ncancer_RCCvsUC_NAMEUC  0.4488039  1.5664374  0.2920805  1.537   0.1244  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4844     2.0642    0.2375    0.9881\ncalor                    0.9999     1.0001    0.9994    1.0004\nageby10                  1.3451     0.7435    1.0190    1.7754\necog_1to5_final          1.3886     0.7201    0.7242    2.6626\ncancer_RCCvsUC_NAMEUC    1.5664     0.6384    0.8837    2.7767\n\nConcordance= 0.675  (se = 0.036 )\nLikelihood ratio test= 20.75  on 5 df,   p=9e-04\nWald test            = 20.38  on 5 df,   p=0.001\nScore (logrank) test = 21.54  on 5 df,   p=6e-04\n\ncox_pfs_allMet_mv3 &lt;-coxph(Surv(pfs_mo,\n                                pod_status)~ fiber_dichotomized + \n                             Impact.TMB.Imputed +\n                             ageby10 + \n                             ecog_1to5_final +\n                             cancer_RCCvsUC_NAME,\n                           all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv3)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    Impact.TMB.Imputed + ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, \n    data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                          coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized    -0.82256   0.43931  0.28929 -2.843  0.00446 **\nImpact.TMB.Imputed    -0.08070   0.92247  0.06581 -1.226  0.22012   \nageby10                0.27994   1.32305  0.14220  1.969  0.04900 * \necog_1to5_final        0.18632   1.20481  0.34864  0.534  0.59305   \ncancer_RCCvsUC_NAMEUC  0.73653   2.08868  0.37273  1.976  0.04815 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4393     2.2763    0.2492    0.7745\nImpact.TMB.Imputed       0.9225     1.0840    0.8108    1.0495\nageby10                  1.3231     0.7558    1.0012    1.7483\necog_1to5_final          1.2048     0.8300    0.6084    2.3860\ncancer_RCCvsUC_NAMEUC    2.0887     0.4788    1.0060    4.3365\n\nConcordance= 0.677  (se = 0.035 )\nLikelihood ratio test= 22.13  on 5 df,   p=5e-04\nWald test            = 22.25  on 5 df,   p=5e-04\nScore (logrank) test = 23.39  on 5 df,   p=3e-04\n\n#Extended Data Figure 2\nkmPFS&lt;-survfit(Surv(pfs_mo, pod_status)~fiber_dichotomized,\n               type=\"kaplan-meier\", data=mUCdataFiber)\n\nggsurvplot(kmPFS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Progression-free survival\",\n           #pval = TRUE,\n           legend=\"none\",\n           title=\"Patients with urothelial cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           xlim=c(0,16),\n           data = mUCdataFiber)\n\n\n\n\n\n\n\n\n\nkmPFS&lt;-survfit(Surv(pfs_mo, pod_status)~fiber_dichotomized,\n               type=\"kaplan-meier\", data=mRCdataFiber)\n\nggsurvplot(kmPFS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Progression-free survival\",\n           #pval = TRUE,\n           legend=\"none\",\n           title=\"Patients with renal cell cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           #xlim=c(0,16),\n           data = mRCdataFiber)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 2: PFS Fiber by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_4_acoa_pathway_family_associations_continued.html",
    "href": "extended_data_figure_4_acoa_pathway_family_associations_continued.html",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 4: Deeper Look at ACOA genes and taxonomy"
    ]
  },
  {
    "objectID": "extended_data_figure_4_acoa_pathway_family_associations_continued.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "href": "extended_data_figure_4_acoa_pathway_family_associations_continued.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "Survival plots as a function of pyruvate gene abundance:",
    "text": "Survival plots as a function of pyruvate gene abundance:\n\nPanel A\n\nRelationship between Rel Abundance of Bacteroidales and Acetyle-CoA pathway abundance.\n\n# We will take the information we need out the phyloseq, and convert it to a dataframe for plotting: \n\nfamily_ps &lt;- readRDS(\"../data/cleaned_data/deid_family_ps.rds\")\n\nfamily_ps %&gt;%\n  filter(grepl(\"Bacteroidales\", Family)) %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=pyruvate, y=total_family), method=lm, color=\"firebrick2\") +\n  geom_point(aes(x=pyruvate, y=total_family),\n             shape=21, size=3, fill=\"firebrick2\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Bacteroidales\"\n  )\n\n\n\n\n\n\n\n\n\nPanel B\n\nPCOA external Cohort\n\nraw_mpa_phy_icb &lt;- readRDS(\"../data/cleaned_data/wargo_phylo.RDS\")\n\nraw_mpa_phy_icb %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Family\") %&gt;%\n  ord_calc(\"PCA\") %&gt;%\n  ord_plot(fill = \"log_acoa\", size = 4, shape=21, alpha=0.6,\n           plot_taxa = 1:3) + #c(\"Lachnospiraceae\", \"Bacteroidaceae\", \"Ruminococcaceae\")) +\n  scale_fill_viridis(option=\"C\", begin = 0, end=1, na.value=\"white\") +\n  theme_classic()\n\n\n\n\n\n\n\n\n\nPanel C\n\nAcetyle CoA Gene abundance and butyric acid relationship\n\nmetabolomics_db &lt;- readRDS(\"../data/cleaned_data/metabolomics_data.rds\")\n\nggplot(metabolomics_db) +\n  geom_smooth(aes(x=log(pyruvate), y=Butyric.acid), method=lm, color=\"#e05f5f\") +\n  geom_point(aes(x=log(pyruvate), y=Butyric.acid),\n             shape=21, size=3, fill=\"#e05f5f\", alpha=0.8) +\n  theme_classic()\n\n\n\n\n\n\n\ncor.test(metabolomics_db$Butyric.acid, log(metabolomics_db$pyruvate))\n\n\n    Pearson's product-moment correlation\n\ndata:  metabolomics_db$Butyric.acid and log(metabolomics_db$pyruvate)\nt = 2.3571, df = 62, p-value = 0.02159\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.04407955 0.49751891\nsample estimates:\n      cor \n0.2867815",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 4: Deeper Look at ACOA genes and taxonomy"
    ]
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html",
    "href": "figure_2_acoa_pathway_icb_outcome.html",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.\nHere are the column names of the data we are plotting:\nfouraminobutyrate, glutarate, lysine and pyruvate represent different parts of the butyrate synthesis pathway.\n[1] \"blinded_subject_id\"    \"id_int\"                \"cohort\"               \n [4] \"age\"                   \"impact_tmb_score\"      \"cpb_drug\"             \n [7] \"ecog\"                  \"best_overall_response\" \"tt_pfs_d\"             \n[10] \"pfs_event\"             \"tt_os_d\"               \"event_os\"             \n[13] \"TMPT\"                  \"WMS_SGPID\"             \"SAMPID\"               \n[16] \"total\"                 \"samp_id\"               \"identifier.y\"         \n[19] \"Shannon\"               \"tx\"                    \"age10\"                \n[22] \"med_buty\"              \"fouraminobutyrate\"     \"gluatarate\"           \n[25] \"lysine\"                \"pyruvate\"",
    "crumbs": [
      "Main Figures",
      "Figure 2: ACoA Pathway and ICB/Survival Outcomes"
    ]
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "href": "figure_2_acoa_pathway_icb_outcome.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Survival plots as a function of pyruvate gene abundance:",
    "text": "Survival plots as a function of pyruvate gene abundance:\n\nPanel A\n\nSurvival by ACoA pathway gene abundance in stool above/below the median\nFirst for overall survival (OS):\n\n# cut the distribution of pyruvate into above/below median:\nacoa_df &lt;- acoa_df %&gt;%\n  mutate(med_p = cut(pyruvate, quantile(pyruvate, probs=seq(0,1,0.5)), c(\"Below Median\", \"Above Median\"))) %&gt;% #ifelse(pyruvate &gt; median(pyruvate, na.rm = T), \"Above Median\", \"Below Median\")) %&gt;%\n  mutate(tt_os_months = tt_os_d/30.44) %&gt;%\n  mutate(tt_pfs_months = tt_pfs_d/30.44) %&gt;%\n  arrange(med_p)\n\nfit&lt;- survfit(Surv(tt_os_months, event_os) ~ med_p, data = acoa_df)\nnames(fit$strata) &lt;- gsub(\"med_p=\", \"\", names(fit$strata))\np &lt;- ggsurvplot(fit,  size = 1,  # change line size\n           linetype = \"solid\", # use solid line\n           break.time.by = 12, # break time axis by 12 months\n           palette = c(\"aquamarine4\", \"coral4\"), # custom color palette\n           conf.int = TRUE, # Add confidence interval\n           pval = TRUE, # Add p-value,\n           legend.title=\"\",\n           risk.table = TRUE, risk.table.y.text.col = TRUE,\n           ylab = \"Survival %\",\n           xlab = \"Time (Months)\",\n           xlim = c(0,48)\n           ) \nprint(p)\n\n\n\n\n\n\n\n\nThen looking at Progression Free Survival (PFS) instead of OS:\n\nfit&lt;- survfit(Surv(tt_pfs_months, pfs_event) ~ med_p, data = acoa_df)\nnames(fit$strata) &lt;- gsub(\"med_p=\", \"\", names(fit$strata))\np &lt;- ggsurvplot(fit,  size = 1,  # change line size\n           linetype = \"solid\", # use solid line\n           break.time.by = 12, # break time axis by 12 months\n           palette = c(\"aquamarine4\", \"coral4\"), # custom color palette\n           conf.int = TRUE, # Add confidence interval\n           pval = TRUE, # Add p-value,\n           legend.title=\"\",\n           risk.table = TRUE, risk.table.y.text.col = TRUE,\n           ylab = \"Survival %\",\n           xlab = \"Time (Months)\",\n           xlim = c(0,48)\n           ) \nprint(p)\n\n\n\n\n\n\n\n\n\nPanel B\n\nRestricted cubic spline adjusted for age, diagnosis, and performance status identifies increasing hazard of overall mortality associated with below-median (&lt;504 RPKM) ACoA pathway gene abundance among ICB recipients. Ticks along the x-axis reflect individual samples\n\nmodel_spline_os &lt;- coxph(Surv(tt_os_d, event_os) ~ rms::rcs(pyruvate,4) + age10 + factor(cohort) + ecog, acoa_df)\nptemp &lt;- termplot(model_spline_os, se=T, plot=F)\nbuterm &lt;- ptemp$pyruvate\ncenter &lt;- buterm$y[which(buterm$y == median(buterm$y))]\nytemp &lt;- buterm$y + outer(buterm$se, c(0, -1.96, 1.96), '*')\nexp_ytemp &lt;- exp(ytemp - center)\n\nspline_data &lt;- data.frame(buty = buterm$x, Estimate = exp_ytemp[,1],\n                          Lower = exp_ytemp[,2], Upper = exp_ytemp[,3])\n\nggplot(spline_data, aes(x = buty)) +\n  geom_ribbon(aes(ymin = Lower, ymax = Upper), fill = \"grey80\", alpha = 0.5) +\n  geom_line(aes(y = Estimate), color = \"blue\") +\n  geom_rug(sides = \"b\") +  # Add rug plot at the bottom ('b') of the plot\n  scale_y_log10() +  # Log scale for y-axis\n  labs(x = \"Pyruvate-pathway genes present\", y = \"Hazard ratio\") +\n  theme_minimal()",
    "crumbs": [
      "Main Figures",
      "Figure 2: ACoA Pathway and ICB/Survival Outcomes"
    ]
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#taxonomy-breakdown-plots",
    "href": "figure_2_acoa_pathway_icb_outcome.html#taxonomy-breakdown-plots",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Taxonomy breakdown plots:",
    "text": "Taxonomy breakdown plots:\nWe will now plot some microbiome data, using a phyloseq object that contains our sequencing data. This object contains a list of the taxonomy of organisms identified, the abundance in each sample, and any associated sample specific metadata in one object.\n\nPanel C\n\n\nps %&gt;%\n  ps_filter(SAMPID %in% acoa_df$SAMPID) %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_acoa\", size = 4, shape=21, alpha=0.6,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0, 0.5, 1)) +\n  theme_classic() +  \n  scale_x_reverse() + \n  labs(\n    fill = \"Log ACOA\"\n  )\n\n\n\n\n\n\n\n\n\nrum_ps &lt;- ps\nsample_data(rum_ps)$log_rum = log(sample_data(ps)$Ruminococcaceae + 0.0001)\nrum_ps %&gt;%\n  ps_filter(SAMPID %in% acoa_df$SAMPID) %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_rum\", size = 4, shape=21, alpha=0.6,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0, 0.65, 1)) +\n  theme_classic()+\n  scale_x_reverse() + \n  labs(\n    fill = \"Log10 Rel Abund.\\nRuminococcaceae\"\n  )\n\n\n\n\n\n\n\n\n\nbac_ps &lt;- ps\nsample_data(bac_ps)$log_bac = log(sample_data(ps)$Bacteroidaceae + 0.0001)\nbac_ps %&gt;%\n  ps_filter(SAMPID %in% acoa_df$SAMPID) %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_bac\", size = 4, shape=21, alpha=0.6,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0, 0.75, 1)) +\n  theme_classic() +\n  scale_x_reverse() + \n  labs(\n    fill = \"Log10 Rel Abund.\\nBacteroidaceae\"\n  )\n\n\n\n\n\n\n\n\n\nPanel D Verification on External Dataset\n\n\ncoh_base_ni &lt;- readRDS(\"../data/coh_butyrate.rds\")\n\n#Figure 2D\nggplot(coh_base_ni, aes(x = response, y = pyruvate)) +\n  geom_boxplot(width = 0.4, outlier.shape = NA, linewidth = 0.6, color = \"black\") +\n  geom_jitter(aes(fill = response), shape = 21, width = 0.15, size = 1.8, stroke = 0.3, color = \"black\", alpha = 0.7) +\n  scale_fill_manual(values = c(\"#999999\", \"#E69F00\")) +\n  scale_x_discrete(labels = c(\"Non-responder\", \"Responder\")) +\n  theme_classic(base_size = 9) +\n  theme(\n    axis.text = element_text(size = 8),\n    axis.title = element_text(size = 9),\n    legend.position = \"none\",\n    axis.line = element_line(color = \"black\", linewidth = 0.5),\n    axis.ticks = element_line(color = \"black\", linewidth = 0.5)\n  ) +\n  xlab(\"\") +\n  ylab(\"ACoA pathway gene abundance (RPKM)\")\n\n\n\n\n\n\n\nwilcox.test(coh_base_ni$pyruvate ~ coh_base_ni$response)\n\n\n    Wilcoxon rank sum exact test\n\ndata:  coh_base_ni$pyruvate by coh_base_ni$response\nW = 36, p-value = 0.002129\nalternative hypothesis: true location shift is not equal to 0\n\ngroup_n &lt;- coh_base_ni %&gt;% count(response)\nprint(group_n)\n\n# A tibble: 2 × 2\n  response     n\n  &lt;chr&gt;    &lt;int&gt;\n1 N           16\n2 Y           13\n\n#adjusted for CMB588\nsummary(glm(response01 ~ log1p(pyruvate) + cbm588, data = coh_base_ni , family = binomial(link = \"logit\")))\n\n\nCall:\nglm(formula = response01 ~ log1p(pyruvate) + cbm588, family = binomial(link = \"logit\"), \n    data = coh_base_ni)\n\nCoefficients:\n                Estimate Std. Error z value Pr(&gt;|z|)  \n(Intercept)      -15.157      7.325  -2.069   0.0385 *\nlog1p(pyruvate)    2.491      1.160   2.148   0.0318 *\ncbm588no-CBM      -1.439      1.022  -1.407   0.1593  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 39.892  on 28  degrees of freedom\nResidual deviance: 26.776  on 26  degrees of freedom\nAIC: 32.776\n\nNumber of Fisher Scoring iterations: 6",
    "crumbs": [
      "Main Figures",
      "Figure 2: ACoA Pathway and ICB/Survival Outcomes"
    ]
  },
  {
    "objectID": "figure_2_acoa_pathway_icb_outcome.html#univariate-cox-survival-analysis",
    "href": "figure_2_acoa_pathway_icb_outcome.html#univariate-cox-survival-analysis",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "Univariate Cox Survival Analysis",
    "text": "Univariate Cox Survival Analysis\n\nPanel E External Data\n\nUnivariate Cox regression analyses PFS relationship to ACoA gene abundance in external cohort.\n\nwargo_surv_df &lt;- readRDS(\"../data/cleaned_data/wargo_pfs_data_for_univariate_model.RDS\")\n\nmodel1_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log(rum), wargo_surv_df)\nmodel2_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log(rum_lach), wargo_surv_df)\nmodel3_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log(clostridiales), wargo_surv_df)\nmodel4_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log(clostridia), wargo_surv_df)\nmodel5_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log(eval(faecalibacterium_prausnitzii+1e-7)), wargo_surv_df)\nmodel6_wargo &lt;- coxph(Surv(pfs_d, pfsevent)~log1p(pyruvate), wargo_surv_df)\n\n\nmodels &lt;- list(model1_wargo, model2_wargo, model3_wargo, model4_wargo, model5_wargo, model6_wargo)\n\n\n\nresults_df &lt;- data.frame()\n\n\nfor (i in seq_along(models)) {\n  model &lt;- models[[i]]\n  summary_model &lt;- summary(model)\n\n\n  hr &lt;- summary_model$coefficients[, \"exp(coef)\"]\n  lower_ci &lt;- summary_model$conf.int[, \"lower .95\"]\n  upper_ci &lt;- summary_model$conf.int[, \"upper .95\"]\n  pvalue &lt;- summary_model$coefficients[, \"Pr(&gt;|z|)\"]\n\n\n  results_df &lt;- rbind(results_df, data.frame(\n    Model = paste0(\"model\", i),\n    HR = hr,\n    Lower_CI = lower_ci,\n    Upper_CI = upper_ci,\n    pvalue = pvalue\n  ))\n}\n\nresults_df$source = rep(\"wargo\", 6)\nresults_df$modelname = c(\"log(Ruminococcaceae)\", \"log(Ruminococcacaeae + Lachnospiraceae)\",\n                             \"log(Clostridiales)\", \"log(Clostridia)\", \"log(F prausnitizii + 1e-7)\", \"log(ACoA\")\n\n\nggplot(results_df) +\n  geom_point(aes(y=fct_rev(fct_reorder(modelname, HR)), x=HR)) +\n  geom_errorbarh(aes(y=fct_rev(fct_reorder(modelname, HR)), xmin=Lower_CI, xmax=Upper_CI), height=0.5)+\n  geom_vline(xintercept=1, lty=2, col=\"gray70\") +\n  scale_x_continuous(trans=\"log\") +\n  theme_classic() +\n  labs(title = \"HR (95% CI) univariable Cox\",\n       subtitle =\"\", y=\"Variable\", x=\"HR\")\n\n\n\n\n\n\n\n\n\nPanel E MSK Data\n\nUnivariate Cox regression analyses PFS relationship to ACoA gene abundance in MSK Observational Data.\n\nmsk_df &lt;- readRDS(\"../data/cleaned_data/interal_msk_data_for_univariate_model.RDS\")\n\nmodel1_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log(rum), msk_df)\nmodel2_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log(rum_lach), msk_df)\nmodel3_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log(clostridiales), msk_df)\nmodel4_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log(clostridia), msk_df)\nmodel5_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log(eval(faecalibacterium_prausnitzii+1e-4)), msk_df)\nmodel6_msk &lt;- coxph(Surv(tt_pfs_d, pfs_event)~log1p(pyruvate), msk_df)\n\n\nmodels &lt;- list(model1_msk, model2_msk, model3_msk, model4_msk, model5_msk, model6_msk)\n\n\n\nresults_df &lt;- data.frame()\n\n\nfor (i in seq_along(models)) {\n  model &lt;- models[[i]]\n  summary_model &lt;- summary(model)\n\n\n  hr &lt;- summary_model$coefficients[, \"exp(coef)\"]\n  lower_ci &lt;- summary_model$conf.int[, \"lower .95\"]\n  upper_ci &lt;- summary_model$conf.int[, \"upper .95\"]\n  pvalue &lt;- summary_model$coefficients[, \"Pr(&gt;|z|)\"]\n\n\n  results_df &lt;- rbind(results_df, data.frame(\n    Model = paste0(\"model\", i),\n    HR = hr,\n    Lower_CI = lower_ci,\n    Upper_CI = upper_ci,\n    pvalue = pvalue\n  ))\n}\n\nresults_df$source = rep(\"msk\", 6)\nresults_df$modelname = c(\"log(Ruminococcaceae)\", \"log(Ruminococcacaeae + Lachnospiraceae)\",\n                             \"log(Clostridiales)\", \"log(Clostridia)\", \"log(F prausnitizii + 1e-7)\", \"log(ACoA\")\n\n\nggplot(results_df) +\n  geom_point(aes(y=fct_rev(fct_reorder(modelname, HR)), x=HR)) +\n  geom_errorbarh(aes(y=fct_rev(fct_reorder(modelname, HR)), xmin=Lower_CI, xmax=Upper_CI), height=0.5)+\n  geom_vline(xintercept=1, lty=2, col=\"gray70\") +\n  scale_x_continuous(trans=\"log\") +\n  theme_classic() +\n  labs(title = \"HR (95% CI) univariable Cox\",\n       subtitle =\"\", y=\"Variable\", x=\"HR\")",
    "crumbs": [
      "Main Figures",
      "Figure 2: ACoA Pathway and ICB/Survival Outcomes"
    ]
  },
  {
    "objectID": "extended_data_figure_7_time_bin_analysis.html",
    "href": "extended_data_figure_7_time_bin_analysis.html",
    "title": " Figure 2 - Butyrate Production Capacity from ACoA Pathway and ICB outcome",
    "section": "",
    "text": "ggplot(diversity_df, aes(x=tmpt_labels_f, y =Inverse_Simpson, fill = tmpt_labels_f)) +\n  geom_boxplot() +\n  scale_y_log10() +\n  theme_classic() +\n  labs(x = \"Days relative to initiation of treatment\", y = \"Alpha diversity\\n(1/Simpson)\") +\n  theme(axis.text = element_text(size=12), \n        text = element_text(size=12),\n        legend.position = \"none\") +\n theme(\n     axis.text = element_text(size = 20), # Adjust axis labels\n     axis.title = element_text(size = 24), # Adjust axis titles\n     plot.title = element_text(size = 24),  # Adjust plot title\n     legend.text = element_text(size = 18),  # Adjust legend text\n     legend.title = element_text(size = 20), # Adjust legend titleMetronidazole\n     strip.text.x = element_text(size = 20),\n     strip.text.y = element_text(size = 20) \n ) + \ntheme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_7_part_a_alpha_diversity_bins.svg\", w = 8, h = 4)\n\n\nggplot(diversity_df, aes(\n    x = PCoA1,\n    y = PCoA2,\n    color = tmpt_cut,\n    shape = prepost_label)) +\n  geom_point(size = 3) +\n  annotate(\"text\", x = .2, y = .3, label = paste(\"Permanova\\nPre vs Post, p =\", adonis_pval), color = \"black\", size = 4) +\n  scale_color_brewer(palette=\"RdBu\") +\n  labs(\n    title = \"β-Diversity (Bray-Curis distance) by relative\\nday of sample collection.\",\n    x = paste0(\"PCoA1 [\", explained_pc1, \"%]\"),\n    y = paste0(\"PCoA2 [\", explained_pc2, \"%]\"),\n    color = \"Time window\\nrelative to\\ninitiation of\\ntreatment\",\n    shape = \"\") +\n  theme_minimal() +\n theme(\n     axis.text = element_text(size = 20), # Adjust axis labels\n     axis.title = element_text(size = 24), # Adjust axis titles\n     plot.title = element_text(size = 24),  # Adjust plot title\n     legend.text = element_text(size = 18),  # Adjust legend text\n     legend.title = element_text(size = 20), # Adjust legend titleMetronidazole\n     strip.text.x = element_text(size = 20),\n     strip.text.y = element_text(size = 20) \n ) \n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_7_part_b_beta_diversity.svg\", w = 7.6, h = 5.5)\n\n\nget_spline_data &lt;- function(data_df, use_500 = F){\n  model_spline_os &lt;- coxph(Surv(tt_os_d, event_os)~rcs(pyruvate,4)+age10+strata(cohort)+ecog, data_df)\n  ptemp &lt;- termplot(model_spline_os, se=T, plot=F)\n  buterm &lt;- ptemp$pyruvate\n  if(use_500){\n    closest_to_500_index &lt;- which.min(abs(buterm$x - 500))\n    center &lt;- buterm$y[closest_to_500_index]\n  }else{\n    center &lt;- buterm$y[which(buterm$y == median(buterm$y))]\n  }\n  ytemp &lt;- buterm$y + outer(buterm$se, c(0, -1.96, 1.96), '*')\n  exp_ytemp &lt;- exp(ytemp - center)\n\n  spline_data &lt;- data.frame(buty = buterm$x, Estimate = exp_ytemp[,1],\n                          Lower = exp_ytemp[,2], Upper = exp_ytemp[,3])\n  return(spline_data)\n  \n}\n\nmsk_df_pre &lt;- msk_df %&gt;% filter(TMPT &lt;= 0)\nmsk_df_preplus &lt;- msk_df %&gt;% filter(TMPT &lt;= 5)\n\n\nspline_data_all &lt;- get_spline_data(msk_df)\nspline_data_pre &lt;- get_spline_data(msk_df_pre)\nspline_data_preplus &lt;- get_spline_data(msk_df_preplus, use_500 = T)\n\nggplot()+\n  geom_ribbon(data=spline_data_all, aes(x=buty, ymin = Lower, ymax = Upper), fill = \"grey80\", alpha = 0.5) +\n  geom_ribbon(data=spline_data_preplus, aes(x=buty, ymin = Lower, ymax = Upper), fill = \"pink\", alpha = 0.5, lty=2) +\n  #geom_ribbon(data=spline_data_pre, aes(x=buty, ymin = Lower, ymax = Upper), fill = \"lightblue\", alpha = 0.25) +\n  geom_line(data=spline_data_all, aes(x=buty, y = Estimate), color = \"blue\") +\n  geom_line(data=spline_data_preplus, aes(x=buty, y = Estimate), color = \"red\", lty=2) +\n  geom_line(data=spline_data_pre, aes(x=buty, y = Estimate), color = \"darkgreen\", lty=2.5) +\n\n  geom_rug(data=spline_data_all, aes(x=buty), sides = \"b\") +  # Add rug plot at the bottom ('b') of the plot\n  geom_rug(data=spline_data_preplus, aes(x=buty), sides = \"b\", color=\"red\", alpha=0.5) +  # Add rug plot at the bottom ('b') of the plot\n  geom_rug(data=spline_data_pre, aes(x=buty), sides = \"b\", color=\"darkgreen\", alpha=0.5) +\n  annotate(\"text\", x = 1650, y = 1.6, label = paste0(\"All samples (n=\", nrow(msk_df), \")\"), color = \"black\", size = 5) +\n  annotate(\"text\", x = 1300, y = .6, label = paste0(\"Day ≤ 5 (n=\", nrow(msk_df_preplus), \")\"), color = \"black\", size = 5) +\n  annotate(\"text\", x = 1420, y = .02, label = paste0(\"Day ≤ 0 only (n=\", nrow(msk_df_pre), \")\"), color = \"black\", size =5) +\n  scale_y_log10() +  # Log scale for y-axis\n  labs(\n    x = \"ACoA-pathway genes present\",\n    y = \"Hazard ratio\",\n    title = \"Sensitivity analysis - day of sample collection relative to start of therapy\") +\n  theme_minimal() +\n  theme(text = element_text(size=20),\n        title = element_blank())\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_7_part_c_sensitivity_time.svg\", w = 8, h = 4)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 7: Time Bin Sensitivity Analysis"
    ]
  },
  {
    "objectID": "extended_data_figure_4_acoa_pathway_family_associations_continued.html#relationfhip-between-relative-abundance-of-top-families-and-acetyl-coa-pathway-abundance",
    "href": "extended_data_figure_4_acoa_pathway_family_associations_continued.html#relationfhip-between-relative-abundance-of-top-families-and-acetyl-coa-pathway-abundance",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "Relationfhip between relative abundance of top families and Acetyl-CoA pathway abundance",
    "text": "Relationfhip between relative abundance of top families and Acetyl-CoA pathway abundance\n\nPanel A\n\nRelationship between Rel Abundance of Lachnospiraceae and Acetyle-CoA pathway abundance.\n\nplotting_ps %&gt;%\n  filter(grepl(\"Lachnospiraceae\", Family)) %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=acoa, y=Abundance), method=lm, color=\"steelblue\") +\n  geom_point(aes(x=acoa, y=Abundance),\n             shape=21, size=3, fill=\"steelblue\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Lachnospiraceae\"\n  )\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_4_part_a_Lachnospiraceae.svg\", w=5, h = 5)\n\n\n#|warning: false\n#|label: p_value_panel_a\nfit &lt;- lm(Abundance ~ acoa, plotting_ps %&gt;%\n  filter(grepl(\"Lachnospiraceae\", Family)))\nsummary(fit)\n\n\nCall:\nlm(formula = Abundance ~ acoa, data = plotting_ps %&gt;% filter(grepl(\"Lachnospiraceae\", \n    Family)))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-9.982 -4.407 -1.105  2.090 37.986 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 8.418826   1.232703   6.830 2.17e-10 ***\nacoa        0.011170   0.001998   5.589 1.10e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.725 on 145 degrees of freedom\nMultiple R-squared:  0.1773,    Adjusted R-squared:  0.1716 \nF-statistic: 31.24 on 1 and 145 DF,  p-value: 1.096e-07\n\n\n\nPanel B\n\nRelationship between Rel Abundance of Ruminococcacae and Acetyle-CoA pathway abundance.\n\nplotting_ps %&gt;%\n  filter(grepl(\"Ruminococcaceae\", Family)) %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=acoa, y=Abundance), method=lm, color=\"goldenrod\") +\n  geom_point(aes(x=acoa, y=Abundance),\n             shape=21, size=3, fill=\"goldenrod\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Ruminococcaceae\"\n  )\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_4_part_b_Ruminococcaceae.svg\", w=5, h = 5)\n\n\n#|warning: false\n#|label: p_value_panel_b\nfit &lt;- lm(Abundance ~ acoa, plotting_ps %&gt;%\n  filter(grepl(\"Ruminococcaceae\", Family)))\nsummary(fit)\n\n\nCall:\nlm(formula = Abundance ~ acoa, data = plotting_ps %&gt;% filter(grepl(\"Ruminococcaceae\", \n    Family)))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17.1756  -5.2271  -0.5834   4.2678  18.3653 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 6.310352   1.285751   4.908 2.45e-06 ***\nacoa        0.013612   0.002084   6.530 1.04e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.014 on 145 degrees of freedom\nMultiple R-squared:  0.2272,    Adjusted R-squared:  0.2219 \nF-statistic: 42.64 on 1 and 145 DF,  p-value: 1.037e-09\n\n\n\nPanel C\n\nRelationship between Rel Abundance of Ruminococcacae and Acetyle-CoA pathway abundance.\n\nplotting_ps %&gt;%\n  filter(grepl(\"Bacteroidaceae\", Family)) %&gt;%\n  ggplot() +\n  geom_smooth(aes(x=acoa, y=Abundance), method=lm, color=\"firebrick2\") +\n  geom_point(aes(x=acoa, y=Abundance),\n             shape=21, size=3, fill=\"firebrick2\", alpha=0.8) +\n  theme_classic() + \n  labs(\n    x = \"Acetyl-CoA pathway gene abundance (RPKM)\",\n    y = \"Bacteroidaceae\"\n  )\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_4_part_c_Bacteroidaceae.svg\", w=5, h = 5)\n\n\n#|warning: false\n#|label: p_value_panel_c\nfit &lt;- lm(Abundance ~ acoa, plotting_ps %&gt;%\n  filter(grepl(\"Bacteroidaceae\", Family)))\nsummary(fit)\n\n\nCall:\nlm(formula = Abundance ~ acoa, data = plotting_ps %&gt;% filter(grepl(\"Bacteroidaceae\", \n    Family)))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.059  -7.357  -1.563   5.631  32.901 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 26.589662   1.891717   14.06  &lt; 2e-16 ***\nacoa        -0.020394   0.003067   -6.65 5.58e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.32 on 145 degrees of freedom\nMultiple R-squared:  0.2337,    Adjusted R-squared:  0.2284 \nF-statistic: 44.22 on 1 and 145 DF,  p-value: 5.577e-10",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 4: Deeper Look at ACOA genes and taxonomy"
    ]
  },
  {
    "objectID": "extended_data_figure_2_butyrate_genes_overall_survival.html",
    "href": "extended_data_figure_2_butyrate_genes_overall_survival.html",
    "title": " Extended Figure 3 Gene Abundance and Hazard Ration, and Univatiate Analysis of Butyrate Pathway.",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.\n[1] \"blinded_subject_id\"    \"id_int\"                \"cohort\"               \n [4] \"age\"                   \"impact_tmb_score\"      \"cpb_drug\"             \n [7] \"ecog\"                  \"best_overall_response\" \"tt_pfs_d\"             \n[10] \"pfs_event\"             \"tt_os_d\"               \"event_os\"             \n[13] \"TMPT\"                  \"WMS_SGPID\"             \"SAMPID\"               \n[16] \"total\"                 \"samp_id\"               \"identifier.y\"         \n[19] \"Shannon\"               \"tx\"                    \"age10\"                \n[22] \"med_buty\"              \"fouraminobutyrate\"     \"gluatarate\"           \n[25] \"lysine\"                \"pyruvate\"",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 2: Butyrate Genes and OS"
    ]
  },
  {
    "objectID": "extended_data_figure_2_butyrate_genes_overall_survival.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "href": "extended_data_figure_2_butyrate_genes_overall_survival.html#survival-plots-as-a-function-of-pyruvate-gene-abundance",
    "title": " Extended Figure 3 Gene Abundance and Hazard Ration, and Univatiate Analysis of Butyrate Pathway.",
    "section": "Survival plots as a function of pyruvate gene abundance:",
    "text": "Survival plots as a function of pyruvate gene abundance:\n\nPanel A\n\nHazard Ratio of Overall Survival Evaluated with respect to Butyrate production gene RPKM.\n\nos_butyrate &lt;-  coxph(Surv(tt_os_d, event_os)~rms::rcs(total,4)+age10+factor(cohort)+ecog,, data = acoa_df)\nptemp &lt;- termplot(os_butyrate, se=T, plot=F)\nbuterm &lt;- ptemp$total\ncenter &lt;- buterm$y[which(buterm$y == median(buterm$y))]\nytemp &lt;- buterm$y + outer(buterm$se, c(0, -1.96, 1.96), '*')\nexp_ytemp &lt;- exp(ytemp - center)\n\nspline_data &lt;- data.frame(buty = buterm$x, Estimate = exp_ytemp[,1],\n                          Lower = exp_ytemp[,2], Upper = exp_ytemp[,3])\n\nggplot(spline_data, aes(x = buty)) +\n  geom_ribbon(aes(ymin = Lower, ymax = Upper), fill = \"grey80\", alpha = 0.5) +\n  geom_line(aes(y = Estimate), color = \"blue\") +\n  geom_rug(sides = \"b\") +  # Add rug plot at the bottom ('b') of the plot\n  scale_y_log10() +  # Log scale for y-axis\n  labs(x = \"Total butyrate-pathway genes present\", y = \"Hazard ratio\") +\n  theme_minimal() +\n theme(\n     axis.text = element_text(size = 24), # Adjust axis labels\n     axis.title = element_text(size = 24), # Adjust axis titles\n     plot.title = element_text(size = 24),  # Adjust plot title\n     legend.text = element_text(size = 18),  # Adjust legend text\n     legend.title = element_text(size = 20), # Adjust legend titleMetronidazole\n     strip.text.x = element_text(size = 20),\n     strip.text.y = element_text(size = 20)\n ) \n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_2_part_a_HR_tot_butyrate.svg\", w = 6.5, h = 4)  \n\n\nPanel B\n\nUnivariate model of OS as a function of total butyrate genes, and each major sub-pathway in the butyrate production gene pathways.\n\nuniv2 &lt;- function(cox, k=1, l=1){\n  coef &lt;- exp(coef(cox))\n  confint &lt;- exp(confint(cox))\n  p &lt;- summary(cox)$coefficients[,5]\n  out &lt;- data.frame(\"HR\"=round(coef,4), round(confint,4), \"p\"=round(p,9))\n  q &lt;- nrow(out)\n  if(l== -1){out &lt;- out[q,]\n  }else{out &lt;- out[k:l,]}\n  return(out)\n\n}\n\nforest_os &lt;- rbind(\nuniv2(coxph(Surv(tt_os_d, event_os)~log(total)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(pyruvate)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(lysine+0.0000001)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(fouraminobutyrate+0.000001)+age10+cohort+ecog, acoa_df)),\nuniv2(coxph(Surv(tt_os_d, event_os)~log(gluatarate+0.000001)+age10+cohort+ecog, acoa_df)))\n\nforest_os %&gt;%\n  rename_with(~ c(\"HR\", \"CI_low\", \"CI_high\", \"p\"), .cols = everything()) %&gt;%\n  rownames_to_column(\"scfa\") %&gt;%\n  ggplot() +\n  geom_vline(xintercept=1, lty=2, size=0.25)+\n  geom_point(aes(x=HR, y=fct_reorder(scfa, HR, .desc = T)))+\n  geom_linerange(aes(xmin=CI_low, xmax=CI_high, y=fct_reorder(scfa, HR)), size=0.5) +\n  scale_x_continuous(transform = \"log\", breaks=round(exp(seq(-2,1.5,0.5)),1)) +\n  theme_classic() +\n  coord_cartesian(xlim=exp(c(-2, 0.3))) + \n  labs(y = \"\") +\n theme(\n     axis.text = element_text(size = 20), # Adjust axis labels\n     axis.title = element_text(size = 20), # Adjust axis titles\n     plot.title = element_text(size = 20),  # Adjust plot title\n     legend.text = element_text(size = 18),  # Adjust legend text\n     legend.title = element_text(size = 18), # Adjust legend titleMetronidazole\n     strip.text.x = element_text(size = 18),\n     strip.text.y = element_text(size = 18)\n ) + \ntheme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_2_part_b_forest_plt.svg\", w = 6.5, h = 4)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 2: Butyrate Genes and OS"
    ]
  },
  {
    "objectID": "extended_data_figure_1_pfs_fiber_disease_type.html",
    "href": "extended_data_figure_1_pfs_fiber_disease_type.html",
    "title": " Extended Figure 1: PFS vs Fiber by Disease Type",
    "section": "",
    "text": "The data we are visualizing here has the following structure:",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 1: PFS and OS by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-a",
    "href": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-a",
    "title": " Extended Figure 1: PFS vs Fiber by Disease Type",
    "section": "Panel A",
    "text": "Panel A\nMortality Hazard for PFS by daily average fiber intake, visualized via partial smoothing spline for pateints with Renal Cell Cancer. Ticks along the x axis represent individual patients.\n\ncox_pfs_allMet_mv &lt;-coxph(Surv(pfs_mo,\n                               pod_status)~ fiber_dichotomized + \n                            ageby10 + \n                            ecog_1to5_final +\n                            cancer_RCCvsUC_NAME,\n                          all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized    -0.8237    0.4388   0.2917 -2.824  0.00475 **\nageby10                0.3010    1.3511   0.1422  2.117  0.03426 * \necog_1to5_final        0.3214    1.3790   0.3315  0.970  0.33227   \ncancer_RCCvsUC_NAMEUC  0.4412    1.5545   0.2914  1.514  0.13006   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4388     2.2790    0.2477    0.7772\nageby10                  1.3511     0.7401    1.0226    1.7853\necog_1to5_final          1.3790     0.7251    0.7202    2.6407\ncancer_RCCvsUC_NAMEUC    1.5545     0.6433    0.8781    2.7520\n\nConcordance= 0.676  (se = 0.036 )\nLikelihood ratio test= 20.55  on 4 df,   p=4e-04\nWald test            = 20.05  on 4 df,   p=5e-04\nScore (logrank) test = 21.25  on 4 df,   p=3e-04\n\ncox_pfs_allMet_mv2 &lt;-coxph(Surv(pfs_mo,\n                                pod_status)~ fiber_dichotomized + \n                             calor +\n                             ageby10 + \n                             ecog_1to5_final +\n                             cancer_RCCvsUC_NAME,\n                           all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv2)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    calor + ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, \n    data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                            coef  exp(coef)   se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized    -0.7247475  0.4844469  0.3636819 -1.993   0.0463 *\ncalor                 -0.0001182  0.9998818  0.0002659 -0.445   0.6566  \nageby10                0.2964480  1.3450727  0.1416315  2.093   0.0363 *\necog_1to5_final        0.3283082  1.3886169  0.3321438  0.988   0.3229  \ncancer_RCCvsUC_NAMEUC  0.4488039  1.5664374  0.2920805  1.537   0.1244  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4844     2.0642    0.2375    0.9881\ncalor                    0.9999     1.0001    0.9994    1.0004\nageby10                  1.3451     0.7435    1.0190    1.7754\necog_1to5_final          1.3886     0.7201    0.7242    2.6626\ncancer_RCCvsUC_NAMEUC    1.5664     0.6384    0.8837    2.7767\n\nConcordance= 0.675  (se = 0.036 )\nLikelihood ratio test= 20.75  on 5 df,   p=9e-04\nWald test            = 20.38  on 5 df,   p=0.001\nScore (logrank) test = 21.54  on 5 df,   p=6e-04\n\ncox_pfs_allMet_mv3 &lt;-coxph(Surv(pfs_mo,\n                                pod_status)~ fiber_dichotomized + \n                             Impact.TMB.Imputed +\n                             ageby10 + \n                             ecog_1to5_final +\n                             cancer_RCCvsUC_NAME,\n                           all_metadata_fiber)\n\nsummary(cox_pfs_allMet_mv3)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    Impact.TMB.Imputed + ageby10 + ecog_1to5_final + cancer_RCCvsUC_NAME, \n    data = all_metadata_fiber)\n\n  n= 88, number of events= 57 \n\n                          coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized    -0.82256   0.43931  0.28929 -2.843  0.00446 **\nImpact.TMB.Imputed    -0.08070   0.92247  0.06581 -1.226  0.22012   \nageby10                0.27994   1.32305  0.14220  1.969  0.04900 * \necog_1to5_final        0.18632   1.20481  0.34864  0.534  0.59305   \ncancer_RCCvsUC_NAMEUC  0.73653   2.08868  0.37273  1.976  0.04815 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized       0.4393     2.2763    0.2492    0.7745\nImpact.TMB.Imputed       0.9225     1.0840    0.8108    1.0495\nageby10                  1.3231     0.7558    1.0012    1.7483\necog_1to5_final          1.2048     0.8300    0.6084    2.3860\ncancer_RCCvsUC_NAMEUC    2.0887     0.4788    1.0060    4.3365\n\nConcordance= 0.677  (se = 0.035 )\nLikelihood ratio test= 22.13  on 5 df,   p=5e-04\nWald test            = 22.25  on 5 df,   p=5e-04\nScore (logrank) test = 23.39  on 5 df,   p=3e-04\n\n\n\nkmPFS&lt;-survfit(Surv(pfs_mo, pod_status)~fiber_dichotomized,\n               type=\"kaplan-meier\", data=mRCdataFiber)\n\npfs_rcc &lt;- ggsurvplot(kmPFS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Progression-free survival\",\n           #pval = TRUE,\n           legend=\"none\",\n           title=\"Patients with renal cell cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           #xlim=c(0,16),\n           data = mRCdataFiber) \n#rcc_plt &lt;- ggsave_workaround(pfs_rcc)\n#ggsave(\"svg/extended_figure_1_part_a_RCC_PFS.svg\", plot =rcc_plt, w=8, h = 5)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 1: PFS and OS by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-b",
    "href": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-b",
    "title": " Extended Figure 1: PFS vs Fiber by Disease Type",
    "section": "Panel B",
    "text": "Panel B\nMortality Hazard for PFS by daily average fiber intake, visualized via partial smoothing spline for pateints with Urothelial Cancer. Ticks along the x axis represent individual patients.\n\n#Extended Data Figure 2\nkmPFS&lt;-survfit(Surv(pfs_mo, pod_status)~fiber_dichotomized,\n               type=\"kaplan-meier\", data=mUCdataFiber)\n\npfs_uc &lt;- ggsurvplot(kmPFS,risk.table=TRUE,\n           xlab=\"Time (months)\", \n           ylab=\"Progression-free survival\",\n           #pval = TRUE,\n           legend=\"none\",\n           title=\"Patients with urothelial cancer on ICB\",\n           legend.title=\"Fiber intake\",\n           legend.labs=c(\"&lt;15 g/day\",\"15+ g/day\"),\n           #surv.median.line = \"hv\",\n           conf.int=TRUE,\n           break.x.by=6,\n           axes.offset=FALSE,\n           xlim=c(0,16),\n           data = mUCdataFiber)\nprint(pfs_uc)\n\n\n\n\n\n\n\n#uc_plt &lt;- ggsave_workaround(pfs_uc)\n#ggsave(\"svg/extended_figure_1_part_b_UC_PFS.svg\", plot = uc_plt, w=8, h = 5)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 1: PFS and OS by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-c",
    "href": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-c",
    "title": " Extended Figure 1: PFS vs Fiber by Disease Type",
    "section": "Panel C",
    "text": "Panel C\nMultivariate Model Progression Free Survival Sensitivity Analysis\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_12 = case_when(aofib&gt;=12~1,\n                                                                              aofib&lt;12~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_14 = case_when(aofib&gt;=14~1,\n                                                                              aofib&lt;14~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_16 = case_when(aofib&gt;=16~1,\n                                                                              aofib&lt;16~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_18 = case_when(aofib&gt;=18~1,\n                                                                              aofib&lt;18~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_20 = case_when(aofib&gt;=20~1,\n                                                                              aofib&lt;20~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_22 = case_when(aofib&gt;=22~1,\n                                                                              aofib&lt;22~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_24 = case_when(aofib&gt;=24~1,\n                                                                              aofib&lt;24~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_26 = case_when(aofib&gt;=26~1,\n                                                                              aofib&lt;26~0))\n\nAllMetdataFiber &lt;- mutate(AllMetdataFiber,  fiber_dichotomized_28 = case_when(aofib&gt;=28~1,\n                                                                              aofib&lt;28~0))\n\n\n###multivariable PFS\n\ncox_pfs_12_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_12 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_12_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_12 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_12 -0.6548    0.5195   0.3279 -1.997   0.0458 *\nageby10                0.2532    1.2881   0.1352  1.873   0.0610 .\necog_1to5_final        0.3422    1.4080   0.3378  1.013   0.3111  \ncancer_RCCvsUC         0.5144    1.6726   0.2932  1.755   0.0793 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_12    0.5195     1.9248    0.2732    0.9879\nageby10                  1.2881     0.7763    0.9883    1.6788\necog_1to5_final          1.4080     0.7102    0.7262    2.7300\ncancer_RCCvsUC           1.6726     0.5979    0.9416    2.9712\n\nConcordance= 0.651  (se = 0.037 )\nLikelihood ratio test= 16.49  on 4 df,   p=0.002\nWald test            = 16.71  on 4 df,   p=0.002\nScore (logrank) test = 17.61  on 4 df,   p=0.001\n\ncox_pfs_14_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_14 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_14_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_14 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized_14 -0.8157    0.4423   0.2982 -2.736  0.00623 **\nageby10                0.2906    1.3372   0.1395  2.084  0.03719 * \necog_1to5_final        0.3283    1.3886   0.3310  0.992  0.32127   \ncancer_RCCvsUC         0.5194    1.6810   0.2912  1.783  0.07453 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_14    0.4423     2.2607    0.2466    0.7935\nageby10                  1.3372     0.7478    1.0174    1.7575\necog_1to5_final          1.3886     0.7202    0.7258    2.6565\ncancer_RCCvsUC           1.6810     0.5949    0.9499    2.9749\n\nConcordance= 0.671  (se = 0.035 )\nLikelihood ratio test= 19.83  on 4 df,   p=5e-04\nWald test            = 19.56  on 4 df,   p=6e-04\nScore (logrank) test = 20.67  on 4 df,   p=4e-04\n\ncox_pfs_15_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_15_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)   \nfiber_dichotomized -0.8237    0.4388   0.2917 -2.824  0.00475 **\nageby10             0.3010    1.3511   0.1422  2.117  0.03426 * \necog_1to5_final     0.3214    1.3790   0.3315  0.970  0.33227   \ncancer_RCCvsUC      0.4412    1.5545   0.2914  1.514  0.13006   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.4388     2.2790    0.2477    0.7772\nageby10               1.3511     0.7401    1.0226    1.7853\necog_1to5_final       1.3790     0.7251    0.7202    2.6407\ncancer_RCCvsUC        1.5545     0.6433    0.8781    2.7520\n\nConcordance= 0.676  (se = 0.036 )\nLikelihood ratio test= 20.55  on 4 df,   p=4e-04\nWald test            = 20.05  on 4 df,   p=5e-04\nScore (logrank) test = 21.25  on 4 df,   p=3e-04\n\ncox_pfs_16_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_16 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_16_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_16 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_16 -0.5650    0.5683   0.2769 -2.041   0.0413 *\nageby10                0.2351    1.2651   0.1346  1.747   0.0807 .\necog_1to5_final        0.3707    1.4488   0.3310  1.120   0.2627  \ncancer_RCCvsUC         0.5380    1.7126   0.2881  1.867   0.0618 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_16    0.5683     1.7595    0.3303    0.9779\nageby10                  1.2651     0.7905    0.9717    1.6469\necog_1to5_final          1.4488     0.6902    0.7573    2.7719\ncancer_RCCvsUC           1.7126     0.5839    0.9737    3.0121\n\nConcordance= 0.656  (se = 0.035 )\nLikelihood ratio test= 16.9  on 4 df,   p=0.002\nWald test            = 16.42  on 4 df,   p=0.003\nScore (logrank) test = 17.21  on 4 df,   p=0.002\n\ncox_pfs_18_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_18 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_18_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_18 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_18 -0.4988    0.6072   0.2785 -1.791   0.0732 .\nageby10                0.2003    1.2218   0.1310  1.529   0.1263  \necog_1to5_final        0.3662    1.4423   0.3308  1.107   0.2683  \ncancer_RCCvsUC         0.6811    1.9761   0.2913  2.338   0.0194 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_18    0.6072     1.6468    0.3518     1.048\nageby10                  1.2218     0.8185    0.9451     1.580\necog_1to5_final          1.4423     0.6933    0.7542     2.758\ncancer_RCCvsUC           1.9761     0.5060    1.1165     3.497\n\nConcordance= 0.644  (se = 0.035 )\nLikelihood ratio test= 16.09  on 4 df,   p=0.003\nWald test            = 15.2  on 4 df,   p=0.004\nScore (logrank) test = 15.9  on 4 df,   p=0.003\n\ncox_pfs_20_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_20 + \n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_20_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_20 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_20 -0.3117    0.7322   0.2897 -1.076   0.2819  \nageby10                0.1936    1.2137   0.1317  1.471   0.1413  \necog_1to5_final        0.4056    1.5002   0.3323  1.220   0.2223  \ncancer_RCCvsUC         0.6137    1.8473   0.2906  2.112   0.0347 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_20    0.7322     1.3658    0.4150     1.292\nageby10                  1.2137     0.8240    0.9376     1.571\necog_1to5_final          1.5002     0.6666    0.7821     2.878\ncancer_RCCvsUC           1.8473     0.5413    1.0451     3.265\n\nConcordance= 0.643  (se = 0.035 )\nLikelihood ratio test= 14.04  on 4 df,   p=0.007\nWald test            = 13.55  on 4 df,   p=0.009\nScore (logrank) test = 14.21  on 4 df,   p=0.007\n\ncox_pfs_22_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_22 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_22_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_22 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_22 -0.4596    0.6315   0.3066 -1.499   0.1339  \nageby10                0.2178    1.2433   0.1305  1.669   0.0950 .\necog_1to5_final        0.3721    1.4508   0.3334  1.116   0.2644  \ncancer_RCCvsUC         0.5981    1.8186   0.2878  2.078   0.0377 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_22    0.6315     1.5835    0.3463     1.152\nageby10                  1.2433     0.8043    0.9628     1.606\necog_1to5_final          1.4508     0.6893    0.7548     2.789\ncancer_RCCvsUC           1.8186     0.5499    1.0345     3.197\n\nConcordance= 0.642  (se = 0.036 )\nLikelihood ratio test= 15.23  on 4 df,   p=0.004\nWald test            = 14.33  on 4 df,   p=0.006\nScore (logrank) test = 15.01  on 4 df,   p=0.005\n\ncox_pfs_24_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_24 +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_24_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_24 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_24 -0.3242    0.7231   0.3193 -1.015   0.3100  \nageby10                0.2071    1.2302   0.1301  1.592   0.1114  \necog_1to5_final        0.4209    1.5233   0.3332  1.263   0.2065  \ncancer_RCCvsUC         0.5943    1.8117   0.2897  2.052   0.0402 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_24    0.7231     1.3829    0.3867     1.352\nageby10                  1.2302     0.8129    0.9532     1.588\necog_1to5_final          1.5233     0.6565    0.7929     2.927\ncancer_RCCvsUC           1.8117     0.5520    1.0269     3.196\n\nConcordance= 0.643  (se = 0.035 )\nLikelihood ratio test= 13.93  on 4 df,   p=0.008\nWald test            = 13.52  on 4 df,   p=0.009\nScore (logrank) test = 14.2  on 4 df,   p=0.007\n\ncox_pfs_26_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_26+\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_26_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_26 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_26 -0.2727    0.7613   0.3527 -0.773   0.4394  \nageby10                0.2111    1.2351   0.1307  1.616   0.1062  \necog_1to5_final        0.4284    1.5349   0.3333  1.286   0.1986  \ncancer_RCCvsUC         0.5763    1.7795   0.2893  1.992   0.0464 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_26    0.7613     1.3135    0.3814     1.520\nageby10                  1.2351     0.8097    0.9560     1.596\necog_1to5_final          1.5349     0.6515    0.7987     2.950\ncancer_RCCvsUC           1.7795     0.5620    1.0094     3.137\n\nConcordance= 0.638  (se = 0.035 )\nLikelihood ratio test= 13.47  on 4 df,   p=0.009\nWald test            = 13.2  on 4 df,   p=0.01\nScore (logrank) test = 13.87  on 4 df,   p=0.008\n\ncox_pfs_28_uv &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized_28+\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC,\n                      AllMetdataFiber)\nsummary(cox_pfs_28_uv)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized_28 + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized_28 -0.2979    0.7424   0.3859 -0.772   0.4402  \nageby10                0.2080    1.2312   0.1303  1.596   0.1104  \necog_1to5_final        0.4167    1.5170   0.3345  1.246   0.2128  \ncancer_RCCvsUC         0.5744    1.7761   0.2897  1.983   0.0474 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                      exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized_28    0.7424     1.3470    0.3485     1.582\nageby10                  1.2312     0.8122    0.9537     1.589\necog_1to5_final          1.5170     0.6592    0.7875     2.922\ncancer_RCCvsUC           1.7761     0.5630    1.0067     3.134\n\nConcordance= 0.639  (se = 0.036 )\nLikelihood ratio test= 13.48  on 4 df,   p=0.009\nWald test            = 13.23  on 4 df,   p=0.01\nScore (logrank) test = 13.89  on 4 df,   p=0.008\n\n#Calculating number of patients categorized as \"high fiber\" as a function of each dichotomization threshold\nsum(AllMetdataFiber$fiber_dichotomized_12) #70\n\n[1] 70\n\nsum(AllMetdataFiber$fiber_dichotomized_14) #62\n\n[1] 62\n\nsum(AllMetdataFiber$fiber_dichotomized) #57\n\n[1] 57\n\nsum(AllMetdataFiber$fiber_dichotomized_16) #52\n\n[1] 52\n\nsum(AllMetdataFiber$fiber_dichotomized_18) #41\n\n[1] 41\n\nsum(AllMetdataFiber$fiber_dichotomized_20) #31\n\n[1] 31\n\nsum(AllMetdataFiber$fiber_dichotomized_22) #27\n\n[1] 27\n\nsum(AllMetdataFiber$fiber_dichotomized_24) #22\n\n[1] 22\n\nsum(AllMetdataFiber$fiber_dichotomized_26) #17\n\n[1] 17\n\nsum(AllMetdataFiber$fiber_dichotomized_28) #14\n\n[1] 14\n\nforestplot_data &lt;- tibble::tibble(mean  = c(0.5195, 0.4423, 0.4388, 0.5683, 0.6072, 0.7322, 0.6315, 0.7231, 0.7613, 0.7424),\n                                  lower = c(0.2732, 0.2466, 0.2477, 0.3303, 0.3518, 0.4150, 0.3463, 0.3867, 0.3814, 0.3485),\n                                  upper = c(0.9879, 0.7935, 0.7772, 0.9779, 1.048, 1.292, 1.152, 1.352, 1.520, 1.582),\n                                  study = c(\"12\", \"14\", \"15\", \"16\", \"18\", \"20\", \"22\", \"24\", \"26\", \"28\"),\n                                  HighFiber  = c(\"70\",\"62\",\"57\",\"52\",\"41\",\"31\",\"27\",\"22\",\"17\",\"14\"),\n                                  #events = c(\"57\",\"57\",\"57\",\"57\"),\n                                  HR = c(\"0.52\", \"0.44\", \"0.44\", \"0.57\", \"0.61\", \"0.73\",\"0.63\",\"0.72\", \"0.76\", \"0.74\"))\nsvg(\"svg/extended_figure_1_part_c_forest_plt.svg\", w = 8, h = 4)\nforestplot_data |&gt;\n  forestplot(labeltext = c(study, HighFiber,HR),\n             clip = c(0.09, 2.5),\n             xlog = TRUE,\n             xlab = \"Hazard ratio for PFS (95% CI)\",\n             #xticks = c(log(0.25),log(0.5),log(1.0),log(2.5)),\n             title = \"Multivariable progression-free survival sensitivity analyis\") |&gt;\n  fp_set_style(box = \"royalblue\",\n               line = \"darkblue\",\n               summary = \"royalblue\") |&gt; \n  fp_add_header(study = c(\"Fiber threshold (g/day)\"),\n                HighFiber = c(\"High-fiber patients (n)\"),\n                #n = c(\"n\"),\n                #events = c(\"Events\"),\n                HR = c(\"HR\"))\n\ndev.copy(svg, \"svg/extended_figure_1_part_c_forest_plt.svg\")\n\nsvg \n  4 \n\ndev.off()\n\npng \n  2",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 1: PFS and OS by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-d",
    "href": "extended_data_figure_1_pfs_fiber_disease_type.html#panel-d",
    "title": " Extended Figure 1: PFS vs Fiber by Disease Type",
    "section": "Panel D",
    "text": "Panel D\nSmoothing spline for PFS as a function of avg grams of daily fiber/avg daily kCal. Each tick corresponds to a patient.\n\n#gram_fiber_per_Kcal_aboveRecommended\n\n\nmultivariate_cox_fiber_per_kCal &lt;-coxph(Surv(pfs_mo,pod_status)~ fiber_dichotomized +\n                        ageby10 + ecog_1to5_final + cancer_RCCvsUC + kcalor,\n                      AllMetdataFiber)\n\nsummary(multivariate_cox_fiber_per_kCal)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ fiber_dichotomized + \n    ageby10 + ecog_1to5_final + cancer_RCCvsUC + kcalor, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                      coef exp(coef) se(coef)      z Pr(&gt;|z|)  \nfiber_dichotomized -0.7247    0.4844   0.3637 -1.993   0.0463 *\nageby10             0.2964    1.3451   0.1416  2.093   0.0363 *\necog_1to5_final     0.3283    1.3886   0.3321  0.988   0.3229  \ncancer_RCCvsUC      0.4488    1.5664   0.2921  1.537   0.1244  \nkcalor             -0.1182    0.8885   0.2659 -0.445   0.6566  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                   exp(coef) exp(-coef) lower .95 upper .95\nfiber_dichotomized    0.4844     2.0642    0.2375    0.9881\nageby10               1.3451     0.7435    1.0190    1.7754\necog_1to5_final       1.3886     0.7201    0.7242    2.6626\ncancer_RCCvsUC        1.5664     0.6384    0.8837    2.7767\nkcalor                0.8885     1.1255    0.5277    1.4961\n\nConcordance= 0.675  (se = 0.036 )\nLikelihood ratio test= 20.75  on 5 df,   p=9e-04\nWald test            = 20.38  on 5 df,   p=0.001\nScore (logrank) test = 21.54  on 5 df,   p=6e-04\n\nunivariate_cox_fiber_per_kCal &lt;-coxph(Surv(pfs_mo,pod_status)~ gram_fiber_per_Kcal_aboveRecommended,\n                      AllMetdataFiber)\n\nsummary(univariate_cox_fiber_per_kCal)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ gram_fiber_per_Kcal_aboveRecommended, \n    data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n                                        coef exp(coef) se(coef)      z Pr(&gt;|z|)\ngram_fiber_per_Kcal_aboveRecommended -0.9234    0.3972   0.4696 -1.966   0.0493\n                                      \ngram_fiber_per_Kcal_aboveRecommended *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                                     exp(coef) exp(-coef) lower .95 upper .95\ngram_fiber_per_Kcal_aboveRecommended    0.3972      2.518    0.1582    0.9971\n\nConcordance= 0.554  (se = 0.025 )\nLikelihood ratio test= 4.96  on 1 df,   p=0.03\nWald test            = 3.87  on 1 df,   p=0.05\nScore (logrank) test = 4.15  on 1 df,   p=0.04\n\nunivariate_cox_fiber_per_kCal &lt;-coxph(Surv(pfs_mo,pod_status)~ aofib,\n                      AllMetdataFiber)\n\nsummary(univariate_cox_fiber_per_kCal)\n\nCall:\ncoxph(formula = Surv(pfs_mo, pod_status) ~ aofib, data = AllMetdataFiber)\n\n  n= 88, number of events= 57 \n\n          coef exp(coef) se(coef)      z Pr(&gt;|z|)  \naofib -0.03380   0.96676  0.01638 -2.064   0.0391 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n      exp(coef) exp(-coef) lower .95 upper .95\naofib    0.9668      1.034    0.9362    0.9983\n\nConcordance= 0.6  (se = 0.038 )\nLikelihood ratio test= 4.73  on 1 df,   p=0.03\nWald test            = 4.26  on 1 df,   p=0.04\nScore (logrank) test = 4.29  on 1 df,   p=0.04\n\np&lt;- makeSpline(AllMetdataFiber, AllMetdataFiber$pfs_mo, AllMetdataFiber$pod_status, \n           AllMetdataFiber$gram_fiber_per_Kcal,\n           xlab = \"(Average daily grams of fiber)/(Average daily kilocalories)\", ylab=\"Hazard ratio (95% CI)\",\n           title=\"Smoothing spline for progression-free survival\",\n           knots=3)\np + \n theme(\n     axis.text = element_text(size = 18), # Adjust axis labels\n     axis.title = element_text(size = 20), # Adjust axis titles\n     plot.title = element_text(size = 24),  # Adjust plot title\n     legend.text = element_text(size = 18),  # Adjust legend text\n     legend.title = element_text(size = 20), # Adjust legend titleMetronidazole\n     strip.text.x = element_text(size = 18),\n     strip.text.y = element_text(size = 18) \n ) \n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_1_part_d_spline.svg\", w=8, h = 5)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 1: PFS and OS by Disease Type"
    ]
  },
  {
    "objectID": "extended_data_figure_5_PCOA_family_and_ACOA_colors_external_melanoma_cohort.html",
    "href": "extended_data_figure_5_PCOA_family_and_ACOA_colors_external_melanoma_cohort.html",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 5: External Melanoma Cohort Beta Diversity"
    ]
  },
  {
    "objectID": "extended_data_figure_5_PCOA_family_and_ACOA_colors_external_melanoma_cohort.html#pcoa-of-external-melanoma-cohort-colored-with-relevant-variables",
    "href": "extended_data_figure_5_PCOA_family_and_ACOA_colors_external_melanoma_cohort.html#pcoa-of-external-melanoma-cohort-colored-with-relevant-variables",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "PCoA of External Melanoma Cohort, Colored with Relevant Variables",
    "text": "PCoA of External Melanoma Cohort, Colored with Relevant Variables\n\nPanel A\n\nPCOA of External Melanoma Cohort Samples, with points colored in by each sample’s log-scaled ACoA RPKM.\n\nps %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_acoa\", size = 2, shape=21, alpha=0.9,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0,.7,1)) +\n  theme_classic() +  \n  scale_y_reverse() + \n  labs(\n    fill = \"Log ACoA\",\n    x = paste(\"PCoA 1 [\", pcoa_1, \"%]\"),\n    y = paste(\"PCoA 2 [\", pcoa_2, \"%]\"),\n    caption = \"\"\n  ) +\n  theme(\n    legend.position = \"None\"\n  )\n\n\n\n\n\n\n\n ggsave(\"svg/extended_figure_5_part_a_log_acoa.svg\", w=3, h = 3)\n\n\nPanel B\n\nPCOA of External Melanoma Cohort Samples, with points colored in by each sample’s log-scaled Ruminococcaceae Relative Abundance.\n\nps %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_rum\", size = 2, shape=21, alpha=0.9,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0,.55,1)) +\n  theme_classic() +  \n  scale_y_reverse() + \n  labs(\n    fill = \"   Log\\nRel. Abund.\",\n    x = paste(\"PCoA 1 [\", pcoa_1, \"%]\"),\n    y = paste(\"PCoA 2 [\", pcoa_2, \"%]\"),\n    caption = \"\"\n  ) +\n  theme(\n    legend.position = \"None\"\n  )\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_5_part_b_log_ruminococcaceae.svg\", w=3, h = 3)\n\n\nPanel C\n\nPCOA of External Melanoma Cohort Samples, with points colored in by each sample’s log-scaled Bacteroidaceae Relative Abundance.\n\nps %&gt;%\n  tax_fix() %&gt;%\n  tax_transform(trans = \"compositional\", rank = \"Species\") %&gt;%\n  dist_calc(\"aitchison\") %&gt;%\n  ord_calc(\"PCoA\") %&gt;%\n  ord_plot(fill = \"log_bac\", size = 2, shape=21, alpha=0.9,\n           plot_taxa = c(1:5)) +\n  scale_fill_gradientn(colours=c(\"#2b3f76\", \"#f0f0f0\", \"#b2182b\"), values=c(0,.8,1)) +\n  theme_classic() +  \n  scale_y_reverse() + \n  labs(\n    fill = \"   Log\\nRel. Abund.\",\n    x = paste(\"PCoA 1 [\", pcoa_1, \"%]\"),\n    y = paste(\"PCoA 2 [\", pcoa_2, \"%]\"),\n    caption = \"\"\n  ) + \n  theme(\n    legend.position = \"None\"\n  )\n\n\n\n\n\n\n\nggsave(\"svg/extended_figure_5_part_c_log_Bacteroidaceae.svg\", w=3, h = 3)",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 5: External Melanoma Cohort Beta Diversity"
    ]
  },
  {
    "objectID": "extended_data_figure_6_acoa_pathway_butyrate.html",
    "href": "extended_data_figure_6_acoa_pathway_butyrate.html",
    "title": " Extended Figure 4 deeper dive into relationship between ACOA pathway abundance and microbiome taxonomy.",
    "section": "",
    "text": "Some of these cells will be executable using only the public data. These section panels  Look like this. Other sections rely on data we are not able to make public (for example patient-level survival data). These section panels  Look like this.\n\nPanel A\n\nAcetyle CoA Gene abundance and butyric acid relationship\n\nmetabolomics_db &lt;- readRDS(\"../data/cleaned_data/metabolomics_data.rds\")\n\nggplot(metabolomics_db) +\n  geom_smooth(aes(x=log(pyruvate), y=Butyric.acid), method=lm, color=\"#e05f5f\") +\n  geom_point(aes(x=log(pyruvate), y=Butyric.acid),\n             shape=21, size=3, fill=\"#e05f5f\", alpha=0.8) +\n  theme_classic()\n\n\n\n\n\n\n\ncor.test(metabolomics_db$Butyric.acid, log(metabolomics_db$pyruvate))\n\n\n    Pearson's product-moment correlation\n\ndata:  metabolomics_db$Butyric.acid and log(metabolomics_db$pyruvate)\nt = 2.3571, df = 62, p-value = 0.02159\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.04407955 0.49751891\nsample estimates:\n      cor \n0.2867815",
    "crumbs": [
      "Extended Figures",
      "Extended Figure 6: ACOA Pathway Breakdown - Butyrate"
    ]
  },
  {
    "objectID": "extended_data_figure_3_maaslin_acoa_analysis.html",
    "href": "extended_data_figure_3_maaslin_acoa_analysis.html",
    "title": " Ext Data Fig 3 - Maaslin",
    "section": "",
    "text": "ps &lt;- readRDS(paste0(data_folder, \"/public_data/sequencing_data/plotting_phyloseq_deidentified.rds\"))\nacoa_df &lt;- readRDS(paste0(data_folder, \"/data/cleaned_data/acoa_data.rds\"))\n\nps_family &lt;- tax_glom(ps, taxrank = \"Family\")\ntax_table(ps_family)[, \"Family\"] &lt;- gsub(\"[^a-zA-Z0-9]\", \"_\", tax_table(ps_family)[, \"Family\"])\nfamily_names &lt;- make.unique(tax_table(ps_family)[, \"Family\"])\ntaxa_names(ps_family) &lt;- family_names\n# Extract feature table (transpose to samples x features)\nif (taxa_are_rows(ps_family)) {\n  feature_table &lt;- as.data.frame(t(otu_table(ps_family)))\n} else {\n  feature_table &lt;- as.data.frame(otu_table(ps_family))\n}\n\n# Extract metadata\nmetadata &lt;- sample_data(ps_family) %&gt;%\n  as.matrix() %&gt;%\n  as.data.frame() %&gt;% \n  rownames_to_column(\"tmp_row_names\") %&gt;%\n  mutate(SAMPID = as.integer(SAMPID)) %&gt;%\n  left_join(acoa_df %&gt;% select(c(pyruvate, SAMPID)), by = \"SAMPID\") %&gt;%\n  rename(acoa = pyruvate) %&gt;% \n  column_to_rownames(\"tmp_row_names\")  # Note that the \"pyruvate\" generating pathway is associated with ACOA, apologies for the inconsistent names\n  \nmetadata &lt;- metadata[match(rownames(metadata), rownames(feature_table)), ]\n\n# Check that sample names match\nstopifnot(identical(rownames(feature_table), rownames(metadata)))\n\n#output at the species level\n#raw ACoA input here since log transform is included in the maaslin algorithm\nfit_out &lt;- maaslin3(input_data = feature_table,\n                    input_metadata = metadata,\n                    output = 'maaslin_output_family_level_abundance',\n                    formula = '~ acoa',\n                    normalization = 'TSS',\n                    transform = 'LOG',\n                    max_significance = 0.1,\n                    median_comparison_abundance = TRUE,\n                    warn_prevalence = FALSE,\n                    min_abundance = 0.1,\n                    evaluate_only = 'abundance',\n                    max_pngs = 250,\n                    cores = 1)\n\n\nnew_metadata &lt;- readRDS(paste0(data_folder, \"/data/cleaned_data/wargo_phylo.rds\")) %&gt;%\n  microViz::ps_melt() %&gt;% \n  mutate(acoa = pyruvate + .001) %&gt;%\n    select(c(Sample, acoa)) %&gt;%\n  unique() %&gt;%\n  column_to_rownames(\"Sample\") %&gt;%\n  phyloseq::sample_data()\n\nps_wargo &lt;- merge_phyloseq(readRDS(paste0(data_folder, \"/data/cleaned_data/wargo_phylo.rds\")), new_metadata)\n#same for Wargo!\n# Collapse taxa to the Family level\nps_wargo_f &lt;- tax_glom(ps_wargo, taxrank = \"Family\")\n\n# Optional: keep only named families\nps_wargo_f &lt;- subset_taxa(ps_wargo_f, !is.na(Family) & Family != \"\")\n\n# Replace NAs and tidy family names\ntax_table(ps_wargo_f)[, \"Family\"] &lt;- gsub(\"[^a-zA-Z0-9]\", \"_\", tax_table(ps_wargo_f)[, \"Family\"])\nfamily_names &lt;- make.unique(tax_table(ps_wargo_f)[, \"Family\"])\ntaxa_names(ps_wargo_f) &lt;- family_names\n\n\n# Extract feature table (transpose to samples x features)\nfeature_table &lt;- as.data.frame(t(otu_table(ps_wargo_f)))\nif (taxa_are_rows(ps_wargo_f)) {\n  feature_table &lt;- as.data.frame(t(otu_table(ps_wargo_f)))\n} else {\n  feature_table &lt;- as.data.frame(otu_table(ps_wargo_f))\n}\n\n# Extract metadata\nmetadata &lt;- data.frame(sample_data(ps_wargo_f))\n\n\n# Check that sample names match\nstopifnot(identical(rownames(feature_table), rownames(metadata)))\n\n\nfit_out &lt;- maaslin3(input_data = feature_table,\n                    input_metadata = metadata,\n                    output = 'wargo_maaslin_output_family_level_abundance',\n                    formula = '~ acoa',\n                    normalization = 'TSS',\n                    transform = 'LOG',\n                    max_significance = 0.1,\n                    median_comparison_abundance = TRUE,\n                    warn_prevalence = FALSE,\n                    min_abundance = 0.1,\n                    evaluate_only = 'abundance',\n                    max_pngs = 250,\n                    cores = 1)"
  }
]